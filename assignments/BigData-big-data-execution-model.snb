{"metadata":{"name":"big-data-execution-model","user_save_timestamp":"1970-01-01T00:00:00.000Z","auto_save_timestamp":"1970-01-01T00:00:00.000Z","language_info":{"name":"scala","file_extension":"scala","codemirror_mode":"text/x-scala"},"trusted":true,"customLocalRepo":null,"customRepos":null,"customDeps":null,"customImports":null,"customArgs":null,"customSparkConf":{"spark.app.name":"Notebook","spark.master":"local[8]","spark.executor.memory":"1G"}},"cells":[{"metadata":{},"cell_type":"markdown","source":"# Big Data: Execution Model\n\n## Deeper Understanding of Spark\n\nThe goal of this exercise is to gain a deeper understanding in what happens \"inside\"."},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"import org.apache.spark.HashPartitioner","outputs":[{"name":"stdout","output_type":"stream","text":"import org.apache.spark.HashPartitioner\n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":1}]},{"metadata":{},"cell_type":"markdown","source":"After importing additional classes not loaded by default, let us explore the specifics of how RDDs are partitioned, and how this affects the query plans that will be executed."},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rdd1 = sc.parallelize(0 to 999,8)","outputs":[{"name":"stdout","output_type":"stream","text":"rdd1: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[16] at parallelize at <console>:47\n"},{"metadata":{},"data":{"text/html":"ParallelCollectionRDD[16] at parallelize at &lt;console&gt;:47"},"output_type":"execute_result","execution_count":2}]},{"metadata":{},"cell_type":"markdown","source":"Remember that evaluation is lazy, and only happens upon actions, not transformations; i.e., so far, nothing happened.\n_Check:_ Spark UI: [jobs](http://localhost:4040/jobs/) and [stages](http://localhost:4040/stages/) are still empty. \n\n(_Note:_ Port number :4040 can be higher, e.g., :4041, depending on how many notebooks you have running in the kernel.)"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"printf( \"Number of partitions: %d\\n\", rdd1.partitions.length)\nrdd1.partitioner","outputs":[{"name":"stdout","output_type":"stream","text":"Number of partitions: 8\nres24: Option[org.apache.spark.Partitioner] = None\n"},{"metadata":{},"data":{"text/html":"None"},"output_type":"execute_result","execution_count":3}]},{"metadata":{},"cell_type":"markdown","source":"The default number of partitions depends on the number of cores in the machine that runs the docker engine; see e.g., `cat /proc/cpuinfo` from a `bash` shell in the docker engine."},{"metadata":{},"cell_type":"markdown","source":"The next command creates pairs of numbers, that we will treat as key-value pairs in the remainder of this notebook.\n\nIf you have not looked at Spark documentation so far, this would be a good time to go through the information on transformations and PairRDD functions:\n- https://spark.apache.org/docs/latest/programming-guide.html#transformations\n- https://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.rdd.PairRDDFunctions"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rddp = rdd1.map(x => (x % 100, 1000 - x))","outputs":[{"name":"stdout","output_type":"stream","text":"rddp: org.apache.spark.rdd.RDD[(Int, Int)] = MapPartitionsRDD[17] at map at <console>:48\n"},{"metadata":{},"data":{"text/html":"MapPartitionsRDD[17] at map at &lt;console&gt;:48"},"output_type":"execute_result","execution_count":4}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddp.take(15)","outputs":[{"name":"stdout","output_type":"stream","text":"res25: Array[(Int, Int)] = Array((0,1000), (1,999), (2,998), (3,997), (4,996), (5,995), (6,994), (7,993), (8,992), (9,991), (10,990), (11,989), (12,988), (13,987), (14,986))\n"},{"metadata":{},"data":{"text/html":"<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anondfdb3493bc3cafda5dc6c09ad01155ac&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:1,&quot;_2&quot;:999},{&quot;_1&quot;:2,&quot;_2&quot;:998},{&quot;_1&quot;:3,&quot;_2&quot;:997},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:5,&quot;_2&quot;:995},{&quot;_1&quot;:6,&quot;_2&quot;:994},{&quot;_1&quot;:7,&quot;_2&quot;:993},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:9,&quot;_2&quot;:991},{&quot;_1&quot;:10,&quot;_2&quot;:990},{&quot;_1&quot;:11,&quot;_2&quot;:989},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:13,&quot;_2&quot;:987},{&quot;_1&quot;:14,&quot;_2&quot;:986}],&quot;genId&quot;:&quot;2018167191&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon93dd1058fa87bb9aaae18e0baa62616b\">\n      Max Points (controlling all tabs)\n    </label><input id=\"input-anon93dd1058fa87bb9aaae18e0baa62616b\" type=\"number\" name=\"input-anon93dd1058fa87bb9aaae18e0baa62616b\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon93dd1058fa87bb9aaae18e0baa62616b\" data-this=\"{&quot;valueId&quot;:&quot;anon93dd1058fa87bb9aaae18e0baa62616b&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <div>\n          <ul class=\"nav nav-tabs\" id=\"ul2018167191\"><li>\n                <a href=\"#tab2018167191-0\"><i class=\"fa fa-table\"/></a>\n              </li><li>\n                <a href=\"#tab2018167191-1\"><i class=\"fa fa-dot-circle-o\"/></a>\n              </li><li>\n                <a href=\"#tab2018167191-2\"><i class=\"fa fa-line-chart\"/></a>\n              </li><li>\n                <a href=\"#tab2018167191-3\"><i class=\"fa fa-bar-chart\"/></a>\n              </li></ul>\n\n          <div class=\"tab-content\" id=\"tab2018167191\"><div class=\"tab-pane\" id=\"tab2018167191-0\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon9b0accdfa9a10d78bacf591b899c3743&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:1,&quot;_2&quot;:999},{&quot;_1&quot;:2,&quot;_2&quot;:998},{&quot;_1&quot;:3,&quot;_2&quot;:997},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:5,&quot;_2&quot;:995},{&quot;_1&quot;:6,&quot;_2&quot;:994},{&quot;_1&quot;:7,&quot;_2&quot;:993},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:9,&quot;_2&quot;:991},{&quot;_1&quot;:10,&quot;_2&quot;:990},{&quot;_1&quot;:11,&quot;_2&quot;:989},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:13,&quot;_2&quot;:987},{&quot;_1&quot;:14,&quot;_2&quot;:986}],&quot;genId&quot;:&quot;1604079604&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon03b35f30ae4fdcdae0d2a144ef48850e\">\n      Max Points\n    </label><input id=\"input-anon03b35f30ae4fdcdae0d2a144ef48850e\" type=\"number\" name=\"input-anon03b35f30ae4fdcdae0d2a144ef48850e\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon03b35f30ae4fdcdae0d2a144ef48850e\" data-this=\"{&quot;valueId&quot;:&quot;anon03b35f30ae4fdcdae0d2a144ef48850e&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon624601a3c077f351cb93ec8f58b4de99&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon536bf122538be1cc15429984b48d4a35&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab2018167191-1\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anone5757c1c375d8430207b1512c421bf3e&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:1,&quot;_2&quot;:999},{&quot;_1&quot;:2,&quot;_2&quot;:998},{&quot;_1&quot;:3,&quot;_2&quot;:997},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:5,&quot;_2&quot;:995},{&quot;_1&quot;:6,&quot;_2&quot;:994},{&quot;_1&quot;:7,&quot;_2&quot;:993},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:9,&quot;_2&quot;:991},{&quot;_1&quot;:10,&quot;_2&quot;:990},{&quot;_1&quot;:11,&quot;_2&quot;:989},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:13,&quot;_2&quot;:987},{&quot;_1&quot;:14,&quot;_2&quot;:986}],&quot;genId&quot;:&quot;1339686323&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/scatterChart'], \n      function(playground, _magicscatterChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicscatterChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon72ba25c071b9cf1d324aba53ae1d7f3c\">\n      Max Points\n    </label><input id=\"input-anon72ba25c071b9cf1d324aba53ae1d7f3c\" type=\"number\" name=\"input-anon72ba25c071b9cf1d324aba53ae1d7f3c\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon72ba25c071b9cf1d324aba53ae1d7f3c\" data-this=\"{&quot;valueId&quot;:&quot;anon72ba25c071b9cf1d324aba53ae1d7f3c&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonc059aca3a207b704be9d1a7cf936b619&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonde9000bc16de9cf753496a2edd987d04&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab2018167191-2\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anond9d64fc5f2796f8fb3e8a17d598e1e5e&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:1,&quot;_2&quot;:999},{&quot;_1&quot;:2,&quot;_2&quot;:998},{&quot;_1&quot;:3,&quot;_2&quot;:997},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:5,&quot;_2&quot;:995},{&quot;_1&quot;:6,&quot;_2&quot;:994},{&quot;_1&quot;:7,&quot;_2&quot;:993},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:9,&quot;_2&quot;:991},{&quot;_1&quot;:10,&quot;_2&quot;:990},{&quot;_1&quot;:11,&quot;_2&quot;:989},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:13,&quot;_2&quot;:987},{&quot;_1&quot;:14,&quot;_2&quot;:986}],&quot;genId&quot;:&quot;1160914361&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/lineChart'], \n      function(playground, _magiclineChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magiclineChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anonc948591c7d03536e07164e3b724b554c\">\n      Max Points\n    </label><input id=\"input-anonc948591c7d03536e07164e3b724b554c\" type=\"number\" name=\"input-anonc948591c7d03536e07164e3b724b554c\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anonc948591c7d03536e07164e3b724b554c\" data-this=\"{&quot;valueId&quot;:&quot;anonc948591c7d03536e07164e3b724b554c&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonee815c1244cb7ccc26e69246e5320103&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonc4071766c8d8586c7e31f7cd81116b0f&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab2018167191-3\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon6519bd17df5b54a8873e740b05fc3907&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:1,&quot;_2&quot;:999},{&quot;_1&quot;:2,&quot;_2&quot;:998},{&quot;_1&quot;:3,&quot;_2&quot;:997},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:5,&quot;_2&quot;:995},{&quot;_1&quot;:6,&quot;_2&quot;:994},{&quot;_1&quot;:7,&quot;_2&quot;:993},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:9,&quot;_2&quot;:991},{&quot;_1&quot;:10,&quot;_2&quot;:990},{&quot;_1&quot;:11,&quot;_2&quot;:989},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:13,&quot;_2&quot;:987},{&quot;_1&quot;:14,&quot;_2&quot;:986}],&quot;genId&quot;:&quot;27289737&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/barChart'], \n      function(playground, _magicbarChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicbarChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon688193e58c1fd6793a3aff3203223be9\">\n      Max Points\n    </label><input id=\"input-anon688193e58c1fd6793a3aff3203223be9\" type=\"number\" name=\"input-anon688193e58c1fd6793a3aff3203223be9\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon688193e58c1fd6793a3aff3203223be9\" data-this=\"{&quot;valueId&quot;:&quot;anon688193e58c1fd6793a3aff3203223be9&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anond4cd6d9e3eeee2d8945e371532c2ad59&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonecbeb3bb0ff52d62c846e2804a8ac4e8&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div></div>\n        </div>\n      </div></div>"},"output_type":"execute_result","execution_count":5}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddp.partitioner","outputs":[{"name":"stdout","output_type":"stream","text":"res26: Option[org.apache.spark.Partitioner] = None\n"},{"metadata":{},"data":{"text/html":"None"},"output_type":"execute_result","execution_count":6}]},{"metadata":{},"cell_type":"markdown","source":"As we see, the default way of processing does not assign a partitioner; the framework partitions the data in the default way, which is merely a guess. Several ways influence how partitioning takes place, where the easiest is to assign a partitioner."},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rddpp = rddp.partitionBy(new HashPartitioner(2))","outputs":[{"name":"stdout","output_type":"stream","text":"rddpp: org.apache.spark.rdd.RDD[(Int, Int)] = ShuffledRDD[18] at partitionBy at <console>:49\n"},{"metadata":{},"data":{"text/html":"ShuffledRDD[18] at partitionBy at &lt;console&gt;:49"},"output_type":"execute_result","execution_count":7}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddpp.partitioner","outputs":[{"name":"stdout","output_type":"stream","text":"res27: Option[org.apache.spark.Partitioner] = Some(org.apache.spark.HashPartitioner@2)\n"},{"metadata":{},"data":{"text/html":"Some(org.apache.spark.HashPartitioner@2)"},"output_type":"execute_result","execution_count":8}]},{"metadata":{},"cell_type":"markdown","source":"See how that influences processing; notice that `rddp` is partitioned in the default way, whereas `rddpp` uses only two partitions, based on our instructions."},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rddpg = rddp.groupByKey()","outputs":[{"name":"stdout","output_type":"stream","text":"rddpg: org.apache.spark.rdd.RDD[(Int, Iterable[Int])] = ShuffledRDD[19] at groupByKey at <console>:49\n"},{"metadata":{},"data":{"text/html":"ShuffledRDD[19] at groupByKey at &lt;console&gt;:49"},"output_type":"execute_result","execution_count":9}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddpg.toDebugString","outputs":[{"name":"stdout","output_type":"stream","text":"res28: String =\n(8) ShuffledRDD[19] at groupByKey at <console>:49 []\n +-(8) MapPartitionsRDD[17] at map at <console>:48 []\n    |  ParallelCollectionRDD[16] at parallelize at <console>:47 []\n"},{"metadata":{},"data":{"text/html":"(8) ShuffledRDD[19] at groupByKey at &lt;console&gt;:49 []\n +-(8) MapPartitionsRDD[17] at map at &lt;console&gt;:48 []\n    |  ParallelCollectionRDD[16] at parallelize at &lt;console&gt;:47 []"},"output_type":"execute_result","execution_count":10}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddpg.partitioner","outputs":[{"name":"stdout","output_type":"stream","text":"res29: Option[org.apache.spark.Partitioner] = Some(org.apache.spark.HashPartitioner@8)\n"},{"metadata":{},"data":{"text/html":"Some(org.apache.spark.HashPartitioner@8)"},"output_type":"execute_result","execution_count":11}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddpg.partitions.map(p => (p, p.index, p.hashCode))","outputs":[{"name":"stdout","output_type":"stream","text":"res30: Array[(org.apache.spark.Partition, Int, Int)] = Array((org.apache.spark.rdd.ShuffledRDDPartition@0,0,0), (org.apache.spark.rdd.ShuffledRDDPartition@1,1,1), (org.apache.spark.rdd.ShuffledRDDPartition@2,2,2), (org.apache.spark.rdd.ShuffledRDDPartition@3,3,3), (org.apache.spark.rdd.ShuffledRDDPartition@4,4,4), (org.apache.spark.rdd.ShuffledRDDPartition@5,5,5), (org.apache.spark.rdd.ShuffledRDDPartition@6,6,6), (org.apache.spark.rdd.ShuffledRDDPartition@7,7,7))\n"},{"metadata":{},"data":{"text/html":"<div class=\"container-fluid\"><div><div class=\"col-md-12\"><div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anona92cea82be8aa0a3da05a0ada7c210c7&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@0&quot;,&quot;_2&quot;:0,&quot;_3&quot;:0},{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@1&quot;,&quot;_2&quot;:1,&quot;_3&quot;:1},{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@2&quot;,&quot;_2&quot;:2,&quot;_3&quot;:2},{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@3&quot;,&quot;_2&quot;:3,&quot;_3&quot;:3},{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@4&quot;,&quot;_2&quot;:4,&quot;_3&quot;:4},{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@5&quot;,&quot;_2&quot;:5,&quot;_3&quot;:5},{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@6&quot;,&quot;_2&quot;:6,&quot;_3&quot;:6},{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@7&quot;,&quot;_2&quot;:7,&quot;_3&quot;:7}],&quot;genId&quot;:&quot;458932217&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\",\"_3\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon92e8ff44e6d5ff7e4d4414eba6b94af7\">\n      Max Points\n    </label><input id=\"input-anon92e8ff44e6d5ff7e4d4414eba6b94af7\" type=\"number\" name=\"input-anon92e8ff44e6d5ff7e4d4414eba6b94af7\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon92e8ff44e6d5ff7e4d4414eba6b94af7\" data-this=\"{&quot;valueId&quot;:&quot;anon92e8ff44e6d5ff7e4d4414eba6b94af7&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonda216cbe14f8741feb1e3ce4e61e3f74&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonffb628ca503d0196d64de1a5dbc82333&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div></div></div></div>"},"output_type":"execute_result","execution_count":12}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rddppg = rddpp.groupByKey()","outputs":[{"name":"stdout","output_type":"stream","text":"rddppg: org.apache.spark.rdd.RDD[(Int, Iterable[Int])] = MapPartitionsRDD[20] at groupByKey at <console>:50\n"},{"metadata":{},"data":{"text/html":"MapPartitionsRDD[20] at groupByKey at &lt;console&gt;:50"},"output_type":"execute_result","execution_count":13}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddppg.partitioner","outputs":[{"name":"stdout","output_type":"stream","text":"res31: Option[org.apache.spark.Partitioner] = Some(org.apache.spark.HashPartitioner@2)\n"},{"metadata":{},"data":{"text/html":"Some(org.apache.spark.HashPartitioner@2)"},"output_type":"execute_result","execution_count":14}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddppg.partitions.map(p => (p, p.index, p.hashCode))","outputs":[{"name":"stdout","output_type":"stream","text":"res32: Array[(org.apache.spark.Partition, Int, Int)] = Array((org.apache.spark.rdd.ShuffledRDDPartition@0,0,0), (org.apache.spark.rdd.ShuffledRDDPartition@1,1,1))\n"},{"metadata":{},"data":{"text/html":"<div class=\"container-fluid\"><div><div class=\"col-md-12\"><div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anonb5b585811d0dd055cf4c6fe9d75f3c97&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@0&quot;,&quot;_2&quot;:0,&quot;_3&quot;:0},{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@1&quot;,&quot;_2&quot;:1,&quot;_3&quot;:1}],&quot;genId&quot;:&quot;2012937045&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\",\"_3\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon45c210605f8767d8d9ce59969ba8756c\">\n      Max Points\n    </label><input id=\"input-anon45c210605f8767d8d9ce59969ba8756c\" type=\"number\" name=\"input-anon45c210605f8767d8d9ce59969ba8756c\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon45c210605f8767d8d9ce59969ba8756c\" data-this=\"{&quot;valueId&quot;:&quot;anon45c210605f8767d8d9ce59969ba8756c&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon6002308ad270d53d6b349fd5f3a293f4&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonf1c0b29b9db93f156feb9c134c7692df&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div></div></div></div>"},"output_type":"execute_result","execution_count":15}]},{"metadata":{},"cell_type":"markdown","source":"Observe how the number of partitions of a groupByKey operation varies depending on the way the input is partitioned. This in turn affects the number of machines that will be at work in subsequent operations. Take a look at the Spark UI to see the difference for the two cases.\n\n_Note: using explicit naming of RDDs helps you keep track of which job corresponds to which case._"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val pgc2 = rddppg.map( {case(x,y) => (x, y.reduce((a,b) => a + b))} )","outputs":[{"name":"stdout","output_type":"stream","text":"pgc2: org.apache.spark.rdd.RDD[(Int, Int)] = MapPartitionsRDD[21] at map at <console>:51\n"},{"metadata":{},"data":{"text/html":"MapPartitionsRDD[21] at map at &lt;console&gt;:51"},"output_type":"execute_result","execution_count":16}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"pgc2.name = \"Partitioned Group Counts (2)\"","outputs":[{"name":"stdout","output_type":"stream","text":"pgc2.name: String = Partitioned Group Counts (2)\n"},{"metadata":{},"data":{"text/html":"Partitioned Group Counts (2)"},"output_type":"execute_result","execution_count":17}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"pgc2.take(10)","outputs":[{"name":"stdout","output_type":"stream","text":"res33: Array[(Int, Int)] = Array((34,5160), (52,4980), (96,4540), (4,5460), (16,5340), (82,4680), (66,4840), (28,5220), (54,4960), (80,4700))\n"},{"metadata":{},"data":{"text/html":"<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon8f01d4a3ee9e9a93cc3b7f6173df0122&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:34,&quot;_2&quot;:5160},{&quot;_1&quot;:52,&quot;_2&quot;:4980},{&quot;_1&quot;:96,&quot;_2&quot;:4540},{&quot;_1&quot;:4,&quot;_2&quot;:5460},{&quot;_1&quot;:16,&quot;_2&quot;:5340},{&quot;_1&quot;:82,&quot;_2&quot;:4680},{&quot;_1&quot;:66,&quot;_2&quot;:4840},{&quot;_1&quot;:28,&quot;_2&quot;:5220},{&quot;_1&quot;:54,&quot;_2&quot;:4960},{&quot;_1&quot;:80,&quot;_2&quot;:4700}],&quot;genId&quot;:&quot;443057056&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon98c9d64145e3d9ebc33767a6b4d9d7a0\">\n      Max Points (controlling all tabs)\n    </label><input id=\"input-anon98c9d64145e3d9ebc33767a6b4d9d7a0\" type=\"number\" name=\"input-anon98c9d64145e3d9ebc33767a6b4d9d7a0\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon98c9d64145e3d9ebc33767a6b4d9d7a0\" data-this=\"{&quot;valueId&quot;:&quot;anon98c9d64145e3d9ebc33767a6b4d9d7a0&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <div>\n          <ul class=\"nav nav-tabs\" id=\"ul443057056\"><li>\n                <a href=\"#tab443057056-0\"><i class=\"fa fa-table\"/></a>\n              </li><li>\n                <a href=\"#tab443057056-1\"><i class=\"fa fa-dot-circle-o\"/></a>\n              </li><li>\n                <a href=\"#tab443057056-2\"><i class=\"fa fa-line-chart\"/></a>\n              </li><li>\n                <a href=\"#tab443057056-3\"><i class=\"fa fa-bar-chart\"/></a>\n              </li></ul>\n\n          <div class=\"tab-content\" id=\"tab443057056\"><div class=\"tab-pane\" id=\"tab443057056-0\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon49efa8630b6f95de74fd673eef68e5c7&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:34,&quot;_2&quot;:5160},{&quot;_1&quot;:52,&quot;_2&quot;:4980},{&quot;_1&quot;:96,&quot;_2&quot;:4540},{&quot;_1&quot;:4,&quot;_2&quot;:5460},{&quot;_1&quot;:16,&quot;_2&quot;:5340},{&quot;_1&quot;:82,&quot;_2&quot;:4680},{&quot;_1&quot;:66,&quot;_2&quot;:4840},{&quot;_1&quot;:28,&quot;_2&quot;:5220},{&quot;_1&quot;:54,&quot;_2&quot;:4960},{&quot;_1&quot;:80,&quot;_2&quot;:4700}],&quot;genId&quot;:&quot;1158912034&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anonce79ab5a5dc655cd2d9d5f0c46c43541\">\n      Max Points\n    </label><input id=\"input-anonce79ab5a5dc655cd2d9d5f0c46c43541\" type=\"number\" name=\"input-anonce79ab5a5dc655cd2d9d5f0c46c43541\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anonce79ab5a5dc655cd2d9d5f0c46c43541\" data-this=\"{&quot;valueId&quot;:&quot;anonce79ab5a5dc655cd2d9d5f0c46c43541&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon6407e942ddd5daff4a70a27d13c1ab72&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon8bf7b1ea9c7f022e03107df1087d7ce5&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab443057056-1\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anona30cdc0c773ac8aa85abbdcd4ec93f60&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:34,&quot;_2&quot;:5160},{&quot;_1&quot;:52,&quot;_2&quot;:4980},{&quot;_1&quot;:96,&quot;_2&quot;:4540},{&quot;_1&quot;:4,&quot;_2&quot;:5460},{&quot;_1&quot;:16,&quot;_2&quot;:5340},{&quot;_1&quot;:82,&quot;_2&quot;:4680},{&quot;_1&quot;:66,&quot;_2&quot;:4840},{&quot;_1&quot;:28,&quot;_2&quot;:5220},{&quot;_1&quot;:54,&quot;_2&quot;:4960},{&quot;_1&quot;:80,&quot;_2&quot;:4700}],&quot;genId&quot;:&quot;77080246&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/scatterChart'], \n      function(playground, _magicscatterChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicscatterChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon018fe9b3e2b6682938fae189aa01bbf4\">\n      Max Points\n    </label><input id=\"input-anon018fe9b3e2b6682938fae189aa01bbf4\" type=\"number\" name=\"input-anon018fe9b3e2b6682938fae189aa01bbf4\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon018fe9b3e2b6682938fae189aa01bbf4\" data-this=\"{&quot;valueId&quot;:&quot;anon018fe9b3e2b6682938fae189aa01bbf4&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonb052d46ff4671921c0c2da072056c7d9&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon1a4080774f2f9e7005697666e5a33dff&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab443057056-2\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon0fe3a0c6857be413c4c71ab31a539780&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:34,&quot;_2&quot;:5160},{&quot;_1&quot;:52,&quot;_2&quot;:4980},{&quot;_1&quot;:96,&quot;_2&quot;:4540},{&quot;_1&quot;:4,&quot;_2&quot;:5460},{&quot;_1&quot;:16,&quot;_2&quot;:5340},{&quot;_1&quot;:82,&quot;_2&quot;:4680},{&quot;_1&quot;:66,&quot;_2&quot;:4840},{&quot;_1&quot;:28,&quot;_2&quot;:5220},{&quot;_1&quot;:54,&quot;_2&quot;:4960},{&quot;_1&quot;:80,&quot;_2&quot;:4700}],&quot;genId&quot;:&quot;2054601680&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/lineChart'], \n      function(playground, _magiclineChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magiclineChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon17962e5f014edc5c8ce411a81eb7ed7a\">\n      Max Points\n    </label><input id=\"input-anon17962e5f014edc5c8ce411a81eb7ed7a\" type=\"number\" name=\"input-anon17962e5f014edc5c8ce411a81eb7ed7a\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon17962e5f014edc5c8ce411a81eb7ed7a\" data-this=\"{&quot;valueId&quot;:&quot;anon17962e5f014edc5c8ce411a81eb7ed7a&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anoned9b204fba40385f90a0b0ca553701d8&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anondfb1b190d542f4c1940c02e9d44ce2ee&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab443057056-3\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon25b8da7f7c329e6cc5a7cfb2f967ae67&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:34,&quot;_2&quot;:5160},{&quot;_1&quot;:52,&quot;_2&quot;:4980},{&quot;_1&quot;:96,&quot;_2&quot;:4540},{&quot;_1&quot;:4,&quot;_2&quot;:5460},{&quot;_1&quot;:16,&quot;_2&quot;:5340},{&quot;_1&quot;:82,&quot;_2&quot;:4680},{&quot;_1&quot;:66,&quot;_2&quot;:4840},{&quot;_1&quot;:28,&quot;_2&quot;:5220},{&quot;_1&quot;:54,&quot;_2&quot;:4960},{&quot;_1&quot;:80,&quot;_2&quot;:4700}],&quot;genId&quot;:&quot;1871278343&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/barChart'], \n      function(playground, _magicbarChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicbarChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anonba537e823edfb4422ef512d8c69c9d7f\">\n      Max Points\n    </label><input id=\"input-anonba537e823edfb4422ef512d8c69c9d7f\" type=\"number\" name=\"input-anonba537e823edfb4422ef512d8c69c9d7f\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anonba537e823edfb4422ef512d8c69c9d7f\" data-this=\"{&quot;valueId&quot;:&quot;anonba537e823edfb4422ef512d8c69c9d7f&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon9dfcc36f84db13a618957606e334a748&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonb71c239d04035ee55ed1664a30a283d3&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div></div>\n        </div>\n      </div></div>"},"output_type":"execute_result","execution_count":18}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"pgc2.partitions.size","outputs":[{"name":"stdout","output_type":"stream","text":"res34: Int = 2\n"},{"metadata":{},"data":{"text/html":"2"},"output_type":"execute_result","execution_count":19}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"pgc2.toDebugString","outputs":[{"name":"stdout","output_type":"stream","text":"res35: String =\n(2) Partitioned Group Counts (2) MapPartitionsRDD[21] at map at <console>:51 []\n |  MapPartitionsRDD[20] at groupByKey at <console>:50 []\n |  ShuffledRDD[18] at partitionBy at <console>:49 []\n +-(8) MapPartitionsRDD[17] at map at <console>:48 []\n    |  ParallelCollectionRDD[16] at parallelize at <console>:47 []\n"},{"metadata":{},"data":{"text/html":"(2) Partitioned Group Counts (2) MapPartitionsRDD[21] at map at &lt;console&gt;:51 []\n |  MapPartitionsRDD[20] at groupByKey at &lt;console&gt;:50 []\n |  ShuffledRDD[18] at partitionBy at &lt;console&gt;:49 []\n +-(8) MapPartitionsRDD[17] at map at &lt;console&gt;:48 []\n    |  ParallelCollectionRDD[16] at parallelize at &lt;console&gt;:47 []"},"output_type":"execute_result","execution_count":20}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"pgc2.partitioner","outputs":[{"name":"stdout","output_type":"stream","text":"res36: Option[org.apache.spark.Partitioner] = None\n"},{"metadata":{},"data":{"text/html":"None"},"output_type":"execute_result","execution_count":21}]},{"metadata":{},"cell_type":"markdown","source":"_Q: do you understand why the partitioner is none? (No worries if not, you will find a clue below.)_"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rddp4 = rddp.partitionBy(new HashPartitioner(4))","outputs":[{"name":"stdout","output_type":"stream","text":"rddp4: org.apache.spark.rdd.RDD[(Int, Int)] = ShuffledRDD[22] at partitionBy at <console>:49\n"},{"metadata":{},"data":{"text/html":"ShuffledRDD[22] at partitionBy at &lt;console&gt;:49"},"output_type":"execute_result","execution_count":22}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddp4.partitioner","outputs":[{"name":"stdout","output_type":"stream","text":"res37: Option[org.apache.spark.Partitioner] = Some(org.apache.spark.HashPartitioner@4)\n"},{"metadata":{},"data":{"text/html":"Some(org.apache.spark.HashPartitioner@4)"},"output_type":"execute_result","execution_count":23}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddp4.take(10)","outputs":[{"name":"stdout","output_type":"stream","text":"res38: Array[(Int, Int)] = Array((0,1000), (4,996), (8,992), (12,988), (16,984), (20,980), (24,976), (28,972), (32,968), (36,964))\n"},{"metadata":{},"data":{"text/html":"<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anond612988e4d2fd1936e1a304b5e178f6a&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:16,&quot;_2&quot;:984},{&quot;_1&quot;:20,&quot;_2&quot;:980},{&quot;_1&quot;:24,&quot;_2&quot;:976},{&quot;_1&quot;:28,&quot;_2&quot;:972},{&quot;_1&quot;:32,&quot;_2&quot;:968},{&quot;_1&quot;:36,&quot;_2&quot;:964}],&quot;genId&quot;:&quot;1720002778&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon8eb295a2c63a680effe8f1e8424b7b64\">\n      Max Points (controlling all tabs)\n    </label><input id=\"input-anon8eb295a2c63a680effe8f1e8424b7b64\" type=\"number\" name=\"input-anon8eb295a2c63a680effe8f1e8424b7b64\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon8eb295a2c63a680effe8f1e8424b7b64\" data-this=\"{&quot;valueId&quot;:&quot;anon8eb295a2c63a680effe8f1e8424b7b64&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <div>\n          <ul class=\"nav nav-tabs\" id=\"ul1720002778\"><li>\n                <a href=\"#tab1720002778-0\"><i class=\"fa fa-table\"/></a>\n              </li><li>\n                <a href=\"#tab1720002778-1\"><i class=\"fa fa-dot-circle-o\"/></a>\n              </li><li>\n                <a href=\"#tab1720002778-2\"><i class=\"fa fa-line-chart\"/></a>\n              </li><li>\n                <a href=\"#tab1720002778-3\"><i class=\"fa fa-bar-chart\"/></a>\n              </li></ul>\n\n          <div class=\"tab-content\" id=\"tab1720002778\"><div class=\"tab-pane\" id=\"tab1720002778-0\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon3be9996a1723b7c354321b605d72f655&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:16,&quot;_2&quot;:984},{&quot;_1&quot;:20,&quot;_2&quot;:980},{&quot;_1&quot;:24,&quot;_2&quot;:976},{&quot;_1&quot;:28,&quot;_2&quot;:972},{&quot;_1&quot;:32,&quot;_2&quot;:968},{&quot;_1&quot;:36,&quot;_2&quot;:964}],&quot;genId&quot;:&quot;1319140512&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon82daef40966b9af3013c5522bfc736fc\">\n      Max Points\n    </label><input id=\"input-anon82daef40966b9af3013c5522bfc736fc\" type=\"number\" name=\"input-anon82daef40966b9af3013c5522bfc736fc\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon82daef40966b9af3013c5522bfc736fc\" data-this=\"{&quot;valueId&quot;:&quot;anon82daef40966b9af3013c5522bfc736fc&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon5a2ab6851def359b36aba30db8afbeee&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon3412d5350805ee1def3da003505b3cbc&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab1720002778-1\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon6ea4d693e3f68da9227e48a0ed9f5146&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:16,&quot;_2&quot;:984},{&quot;_1&quot;:20,&quot;_2&quot;:980},{&quot;_1&quot;:24,&quot;_2&quot;:976},{&quot;_1&quot;:28,&quot;_2&quot;:972},{&quot;_1&quot;:32,&quot;_2&quot;:968},{&quot;_1&quot;:36,&quot;_2&quot;:964}],&quot;genId&quot;:&quot;1776539785&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/scatterChart'], \n      function(playground, _magicscatterChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicscatterChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anone5c0a65361b4021362f9f759adb71dae\">\n      Max Points\n    </label><input id=\"input-anone5c0a65361b4021362f9f759adb71dae\" type=\"number\" name=\"input-anone5c0a65361b4021362f9f759adb71dae\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anone5c0a65361b4021362f9f759adb71dae\" data-this=\"{&quot;valueId&quot;:&quot;anone5c0a65361b4021362f9f759adb71dae&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon44c4b88475c18300fb5bbd5ee9a18f68&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon9fba33bf19764b7f2d03ff2d8dcba2fb&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab1720002778-2\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon60b4cbfdc9d90568655fa5d600ab7016&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:16,&quot;_2&quot;:984},{&quot;_1&quot;:20,&quot;_2&quot;:980},{&quot;_1&quot;:24,&quot;_2&quot;:976},{&quot;_1&quot;:28,&quot;_2&quot;:972},{&quot;_1&quot;:32,&quot;_2&quot;:968},{&quot;_1&quot;:36,&quot;_2&quot;:964}],&quot;genId&quot;:&quot;485643425&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/lineChart'], \n      function(playground, _magiclineChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magiclineChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon9adfc858d10e0cbb93f1c71d34b66816\">\n      Max Points\n    </label><input id=\"input-anon9adfc858d10e0cbb93f1c71d34b66816\" type=\"number\" name=\"input-anon9adfc858d10e0cbb93f1c71d34b66816\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon9adfc858d10e0cbb93f1c71d34b66816\" data-this=\"{&quot;valueId&quot;:&quot;anon9adfc858d10e0cbb93f1c71d34b66816&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonea3f9cb4a26cea32b617db51c65bd6e0&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon6778bbcdd676601f687e7662b39d2157&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab1720002778-3\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon01fdd5f9c56a21fb68280286e4fc910e&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:16,&quot;_2&quot;:984},{&quot;_1&quot;:20,&quot;_2&quot;:980},{&quot;_1&quot;:24,&quot;_2&quot;:976},{&quot;_1&quot;:28,&quot;_2&quot;:972},{&quot;_1&quot;:32,&quot;_2&quot;:968},{&quot;_1&quot;:36,&quot;_2&quot;:964}],&quot;genId&quot;:&quot;1225208636&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/barChart'], \n      function(playground, _magicbarChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicbarChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anond7e66ecfe60b06217e15a7235bc3456d\">\n      Max Points\n    </label><input id=\"input-anond7e66ecfe60b06217e15a7235bc3456d\" type=\"number\" name=\"input-anond7e66ecfe60b06217e15a7235bc3456d\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anond7e66ecfe60b06217e15a7235bc3456d\" data-this=\"{&quot;valueId&quot;:&quot;anond7e66ecfe60b06217e15a7235bc3456d&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon811593a89f9ddc85798293de5840c562&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anondf68c9f74c2f5d59734b342c9c9d6568&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div></div>\n        </div>\n      </div></div>"},"output_type":"execute_result","execution_count":24}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rddA = rddp4.values.map( x => x  + 10 )","outputs":[{"name":"stdout","output_type":"stream","text":"rddA: org.apache.spark.rdd.RDD[Int] = MapPartitionsRDD[24] at map at <console>:50\n"},{"metadata":{},"data":{"text/html":"MapPartitionsRDD[24] at map at &lt;console&gt;:50"},"output_type":"execute_result","execution_count":25}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddA.partitioner","outputs":[{"name":"stdout","output_type":"stream","text":"res39: Option[org.apache.spark.Partitioner] = None\n"},{"metadata":{},"data":{"text/html":"None"},"output_type":"execute_result","execution_count":26}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rddB = rddp4.mapValues( x => x + 10 )","outputs":[{"name":"stdout","output_type":"stream","text":"rddB: org.apache.spark.rdd.RDD[(Int, Int)] = MapPartitionsRDD[25] at mapValues at <console>:50\n"},{"metadata":{},"data":{"text/html":"MapPartitionsRDD[25] at mapValues at &lt;console&gt;:50"},"output_type":"execute_result","execution_count":27}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddB.partitioner","outputs":[{"name":"stdout","output_type":"stream","text":"res40: Option[org.apache.spark.Partitioner] = Some(org.apache.spark.HashPartitioner@4)\n"},{"metadata":{},"data":{"text/html":"Some(org.apache.spark.HashPartitioner@4)"},"output_type":"execute_result","execution_count":28}]},{"metadata":{},"cell_type":"markdown","source":"Summarizing: partitioning depends on the distributed operations that are executed, and only operations with guarantees about the output distribution will carry an existing partitioner over to its result.\n\nAnother way to control the level of parallellism during query execution is to use the `repartition` and `coalesce` operations. "},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rddC = rddA.repartition(2)","outputs":[{"name":"stdout","output_type":"stream","text":"rddC: org.apache.spark.rdd.RDD[Int] = MapPartitionsRDD[29] at repartition at <console>:51\n"},{"metadata":{},"data":{"text/html":"MapPartitionsRDD[29] at repartition at &lt;console&gt;:51"},"output_type":"execute_result","execution_count":29}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddC.partitions.map(p => (p, p.index, p.hashCode))","outputs":[{"name":"stdout","output_type":"stream","text":"res41: Array[(org.apache.spark.Partition, Int, Int)] = Array((CoalescedRDDPartition(0,ShuffledRDD[27] at repartition at <console>:51,[I@3f23c615,None),0,0), (CoalescedRDDPartition(1,ShuffledRDD[27] at repartition at <console>:51,[I@45a1ad15,None),1,1))\n"},{"metadata":{},"data":{"text/html":"<div class=\"container-fluid\"><div><div class=\"col-md-12\"><div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon03666b306d6e2dc775dc3e70ab24d7ff&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;CoalescedRDDPartition(0,ShuffledRDD[27] at repartition at &lt;console&gt;:51,[I@3f23c615,None)&quot;,&quot;_2&quot;:0,&quot;_3&quot;:0},{&quot;_1&quot;:&quot;CoalescedRDDPartition(1,ShuffledRDD[27] at repartition at &lt;console&gt;:51,[I@45a1ad15,None)&quot;,&quot;_2&quot;:1,&quot;_3&quot;:1}],&quot;genId&quot;:&quot;18512905&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\",\"_3\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anondf2d0a26fa666b8c892237d39754781d\">\n      Max Points\n    </label><input id=\"input-anondf2d0a26fa666b8c892237d39754781d\" type=\"number\" name=\"input-anondf2d0a26fa666b8c892237d39754781d\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anondf2d0a26fa666b8c892237d39754781d\" data-this=\"{&quot;valueId&quot;:&quot;anondf2d0a26fa666b8c892237d39754781d&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonc87d301af9dd5229619321fc720aff21&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon1ebd826e7f79c5e1ad70d16244f48b17&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div></div></div></div>"},"output_type":"execute_result","execution_count":30}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddC.toDebugString","outputs":[{"name":"stdout","output_type":"stream","text":"res42: String =\n(2) MapPartitionsRDD[29] at repartition at <console>:51 []\n |  CoalescedRDD[28] at repartition at <console>:51 []\n |  ShuffledRDD[27] at repartition at <console>:51 []\n +-(4) MapPartitionsRDD[26] at repartition at <console>:51 []\n    |  MapPartitionsRDD[24] at map at <console>:50 []\n    |  MapPartitionsRDD[23] at values at <console>:50 []\n    |  ShuffledRDD[22] at partitionBy at <console>:49 []\n    +-(8) MapPartitionsRDD[17] at map at <console>:48 []\n       |  ParallelCollectionRDD[16] at parallelize at <console>:47 []\n"},{"metadata":{},"data":{"text/html":"(2) MapPartitionsRDD[29] at repartition at &lt;console&gt;:51 []\n |  CoalescedRDD[28] at repartition at &lt;console&gt;:51 []\n |  ShuffledRDD[27] at repartition at &lt;console&gt;:51 []\n +-(4) MapPartitionsRDD[26] at repartition at &lt;console&gt;:51 []\n    |  MapPartitionsRDD[24] at map at &lt;console&gt;:50 []\n    |  MapPartitionsRDD[23] at values at &lt;console&gt;:50 []\n    |  ShuffledRDD[22] at partitionBy at &lt;console&gt;:49 []\n    +-(8) MapPartitionsRDD[17] at map at &lt;console&gt;:48 []\n       |  ParallelCollectionRDD[16] at parallelize at &lt;console&gt;:47 []"},"output_type":"execute_result","execution_count":31}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rddD = rddB.coalesce(2)","outputs":[{"name":"stdout","output_type":"stream","text":"rddD: org.apache.spark.rdd.RDD[(Int, Int)] = CoalescedRDD[30] at coalesce at <console>:51\n"},{"metadata":{},"data":{"text/html":"CoalescedRDD[30] at coalesce at &lt;console&gt;:51"},"output_type":"execute_result","execution_count":32}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddD.toDebugString","outputs":[{"name":"stdout","output_type":"stream","text":"res43: String =\n(2) CoalescedRDD[30] at coalesce at <console>:51 []\n |  MapPartitionsRDD[25] at mapValues at <console>:50 []\n |  ShuffledRDD[22] at partitionBy at <console>:49 []\n +-(8) MapPartitionsRDD[17] at map at <console>:48 []\n    |  ParallelCollectionRDD[16] at parallelize at <console>:47 []\n"},{"metadata":{},"data":{"text/html":"(2) CoalescedRDD[30] at coalesce at &lt;console&gt;:51 []\n |  MapPartitionsRDD[25] at mapValues at &lt;console&gt;:50 []\n |  ShuffledRDD[22] at partitionBy at &lt;console&gt;:49 []\n +-(8) MapPartitionsRDD[17] at map at &lt;console&gt;:48 []\n    |  ParallelCollectionRDD[16] at parallelize at &lt;console&gt;:47 []"},"output_type":"execute_result","execution_count":33}]},{"metadata":{},"cell_type":"markdown","source":"Remember that we need actions for things to happen - so if you inspect the Spark UI, there are now no query plans corresponding to the above commands. Let us take two samples from the results. Do you understand the jobs and stages that you find in the Spark UI?"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddC.takeSample(true, 10);","outputs":[{"name":"stdout","output_type":"stream","text":"res50: Array[Int] = Array(126, 746, 503, 465, 881, 256, 986, 388, 575, 524)\n"},{"metadata":{},"data":{"text/html":"<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon080a0ccb6ae69de6d7e36f9ab54c48ce&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:126},{&quot;_1&quot;:1,&quot;_2&quot;:746},{&quot;_1&quot;:2,&quot;_2&quot;:503},{&quot;_1&quot;:3,&quot;_2&quot;:465},{&quot;_1&quot;:4,&quot;_2&quot;:881},{&quot;_1&quot;:5,&quot;_2&quot;:256},{&quot;_1&quot;:6,&quot;_2&quot;:986},{&quot;_1&quot;:7,&quot;_2&quot;:388},{&quot;_1&quot;:8,&quot;_2&quot;:575},{&quot;_1&quot;:9,&quot;_2&quot;:524}],&quot;genId&quot;:&quot;626410709&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anona4c44d66de8b1d222b326ca278d24f42\">\n      Max Points (controlling all tabs)\n    </label><input id=\"input-anona4c44d66de8b1d222b326ca278d24f42\" type=\"number\" name=\"input-anona4c44d66de8b1d222b326ca278d24f42\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anona4c44d66de8b1d222b326ca278d24f42\" data-this=\"{&quot;valueId&quot;:&quot;anona4c44d66de8b1d222b326ca278d24f42&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <div>\n          <ul class=\"nav nav-tabs\" id=\"ul626410709\"><li>\n                <a href=\"#tab626410709-0\"><i class=\"fa fa-table\"/></a>\n              </li><li>\n                <a href=\"#tab626410709-1\"><i class=\"fa fa-dot-circle-o\"/></a>\n              </li><li>\n                <a href=\"#tab626410709-2\"><i class=\"fa fa-line-chart\"/></a>\n              </li><li>\n                <a href=\"#tab626410709-3\"><i class=\"fa fa-bar-chart\"/></a>\n              </li></ul>\n\n          <div class=\"tab-content\" id=\"tab626410709\"><div class=\"tab-pane\" id=\"tab626410709-0\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anone6007e997c6648c88862757ed1057679&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:126},{&quot;_1&quot;:1,&quot;_2&quot;:746},{&quot;_1&quot;:2,&quot;_2&quot;:503},{&quot;_1&quot;:3,&quot;_2&quot;:465},{&quot;_1&quot;:4,&quot;_2&quot;:881},{&quot;_1&quot;:5,&quot;_2&quot;:256},{&quot;_1&quot;:6,&quot;_2&quot;:986},{&quot;_1&quot;:7,&quot;_2&quot;:388},{&quot;_1&quot;:8,&quot;_2&quot;:575},{&quot;_1&quot;:9,&quot;_2&quot;:524}],&quot;genId&quot;:&quot;1702421113&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anonbcaf82f27348361e23d8a5f3427c3e4a\">\n      Max Points\n    </label><input id=\"input-anonbcaf82f27348361e23d8a5f3427c3e4a\" type=\"number\" name=\"input-anonbcaf82f27348361e23d8a5f3427c3e4a\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anonbcaf82f27348361e23d8a5f3427c3e4a\" data-this=\"{&quot;valueId&quot;:&quot;anonbcaf82f27348361e23d8a5f3427c3e4a&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonda879a33b3a22ce86895b63b78232684&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon7d9dfa5ba7f819c2b1d67788b641ecb6&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab626410709-1\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon3ae875c9112747e206b0bcfd35738a69&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:126},{&quot;_1&quot;:1,&quot;_2&quot;:746},{&quot;_1&quot;:2,&quot;_2&quot;:503},{&quot;_1&quot;:3,&quot;_2&quot;:465},{&quot;_1&quot;:4,&quot;_2&quot;:881},{&quot;_1&quot;:5,&quot;_2&quot;:256},{&quot;_1&quot;:6,&quot;_2&quot;:986},{&quot;_1&quot;:7,&quot;_2&quot;:388},{&quot;_1&quot;:8,&quot;_2&quot;:575},{&quot;_1&quot;:9,&quot;_2&quot;:524}],&quot;genId&quot;:&quot;269317677&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/scatterChart'], \n      function(playground, _magicscatterChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicscatterChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anone8ba51b86bc22d307df7d0bc4f704237\">\n      Max Points\n    </label><input id=\"input-anone8ba51b86bc22d307df7d0bc4f704237\" type=\"number\" name=\"input-anone8ba51b86bc22d307df7d0bc4f704237\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anone8ba51b86bc22d307df7d0bc4f704237\" data-this=\"{&quot;valueId&quot;:&quot;anone8ba51b86bc22d307df7d0bc4f704237&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonc2bba5668c8cce2425511b10ef2e1934&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonbfee2ee26496bfc3c2277423527ee871&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab626410709-2\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anonc656f90b8b4fe69ca9f0d0ae9aba7ce2&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:126},{&quot;_1&quot;:1,&quot;_2&quot;:746},{&quot;_1&quot;:2,&quot;_2&quot;:503},{&quot;_1&quot;:3,&quot;_2&quot;:465},{&quot;_1&quot;:4,&quot;_2&quot;:881},{&quot;_1&quot;:5,&quot;_2&quot;:256},{&quot;_1&quot;:6,&quot;_2&quot;:986},{&quot;_1&quot;:7,&quot;_2&quot;:388},{&quot;_1&quot;:8,&quot;_2&quot;:575},{&quot;_1&quot;:9,&quot;_2&quot;:524}],&quot;genId&quot;:&quot;1375155054&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/lineChart'], \n      function(playground, _magiclineChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magiclineChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anonc03e8a007f38cb083c7d3aea93ecdf2a\">\n      Max Points\n    </label><input id=\"input-anonc03e8a007f38cb083c7d3aea93ecdf2a\" type=\"number\" name=\"input-anonc03e8a007f38cb083c7d3aea93ecdf2a\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anonc03e8a007f38cb083c7d3aea93ecdf2a\" data-this=\"{&quot;valueId&quot;:&quot;anonc03e8a007f38cb083c7d3aea93ecdf2a&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon9879895a20cb65907230ad84283a70e9&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon33b46878eabfe2536900fa9000a4ec54&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab626410709-3\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon29acc5d13491e6ba7c052e137361b67a&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:126},{&quot;_1&quot;:1,&quot;_2&quot;:746},{&quot;_1&quot;:2,&quot;_2&quot;:503},{&quot;_1&quot;:3,&quot;_2&quot;:465},{&quot;_1&quot;:4,&quot;_2&quot;:881},{&quot;_1&quot;:5,&quot;_2&quot;:256},{&quot;_1&quot;:6,&quot;_2&quot;:986},{&quot;_1&quot;:7,&quot;_2&quot;:388},{&quot;_1&quot;:8,&quot;_2&quot;:575},{&quot;_1&quot;:9,&quot;_2&quot;:524}],&quot;genId&quot;:&quot;1965093592&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/barChart'], \n      function(playground, _magicbarChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicbarChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon8beb53b47968d52c26bae83d67a9dc50\">\n      Max Points\n    </label><input id=\"input-anon8beb53b47968d52c26bae83d67a9dc50\" type=\"number\" name=\"input-anon8beb53b47968d52c26bae83d67a9dc50\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon8beb53b47968d52c26bae83d67a9dc50\" data-this=\"{&quot;valueId&quot;:&quot;anon8beb53b47968d52c26bae83d67a9dc50&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonfcf30a49a3001e315374736c3d702f61&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon4d0c4df74eea5fde924c2f798ca1ca4c&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div></div>\n        </div>\n      </div></div>"},"output_type":"execute_result","execution_count":40}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddD.takeSample(true, 10);","outputs":[{"name":"stdout","output_type":"stream","text":"res51: Array[(Int, Int)] = Array((66,144), (53,957), (31,279), (81,29), (59,51), (72,438), (77,733), (71,839), (64,46), (48,862))\n"},{"metadata":{},"data":{"text/html":"<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon9f87f8ddd1e72dfbb1b6fcb43094f97c&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:66,&quot;_2&quot;:144},{&quot;_1&quot;:53,&quot;_2&quot;:957},{&quot;_1&quot;:31,&quot;_2&quot;:279},{&quot;_1&quot;:81,&quot;_2&quot;:29},{&quot;_1&quot;:59,&quot;_2&quot;:51},{&quot;_1&quot;:72,&quot;_2&quot;:438},{&quot;_1&quot;:77,&quot;_2&quot;:733},{&quot;_1&quot;:71,&quot;_2&quot;:839},{&quot;_1&quot;:64,&quot;_2&quot;:46},{&quot;_1&quot;:48,&quot;_2&quot;:862}],&quot;genId&quot;:&quot;107359769&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anona61e952284cb69efd7e9fb497b1c7ffe\">\n      Max Points (controlling all tabs)\n    </label><input id=\"input-anona61e952284cb69efd7e9fb497b1c7ffe\" type=\"number\" name=\"input-anona61e952284cb69efd7e9fb497b1c7ffe\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anona61e952284cb69efd7e9fb497b1c7ffe\" data-this=\"{&quot;valueId&quot;:&quot;anona61e952284cb69efd7e9fb497b1c7ffe&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <div>\n          <ul class=\"nav nav-tabs\" id=\"ul107359769\"><li>\n                <a href=\"#tab107359769-0\"><i class=\"fa fa-table\"/></a>\n              </li><li>\n                <a href=\"#tab107359769-1\"><i class=\"fa fa-dot-circle-o\"/></a>\n              </li><li>\n                <a href=\"#tab107359769-2\"><i class=\"fa fa-line-chart\"/></a>\n              </li><li>\n                <a href=\"#tab107359769-3\"><i class=\"fa fa-bar-chart\"/></a>\n              </li></ul>\n\n          <div class=\"tab-content\" id=\"tab107359769\"><div class=\"tab-pane\" id=\"tab107359769-0\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anond7207bd801c50642f75d81a2f9a1f927&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:66,&quot;_2&quot;:144},{&quot;_1&quot;:53,&quot;_2&quot;:957},{&quot;_1&quot;:31,&quot;_2&quot;:279},{&quot;_1&quot;:81,&quot;_2&quot;:29},{&quot;_1&quot;:59,&quot;_2&quot;:51},{&quot;_1&quot;:72,&quot;_2&quot;:438},{&quot;_1&quot;:77,&quot;_2&quot;:733},{&quot;_1&quot;:71,&quot;_2&quot;:839},{&quot;_1&quot;:64,&quot;_2&quot;:46},{&quot;_1&quot;:48,&quot;_2&quot;:862}],&quot;genId&quot;:&quot;217663653&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anona4fbab6c95c51c1b3b3725498b5d6dbc\">\n      Max Points\n    </label><input id=\"input-anona4fbab6c95c51c1b3b3725498b5d6dbc\" type=\"number\" name=\"input-anona4fbab6c95c51c1b3b3725498b5d6dbc\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anona4fbab6c95c51c1b3b3725498b5d6dbc\" data-this=\"{&quot;valueId&quot;:&quot;anona4fbab6c95c51c1b3b3725498b5d6dbc&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon52eee7886dce8d768ff2e1ee46a81458&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anone94dc5d1f61f0a9bc999fa59a14f7ba2&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab107359769-1\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon8d7b0661cf5fa930741684877f3d4e0b&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:66,&quot;_2&quot;:144},{&quot;_1&quot;:53,&quot;_2&quot;:957},{&quot;_1&quot;:31,&quot;_2&quot;:279},{&quot;_1&quot;:81,&quot;_2&quot;:29},{&quot;_1&quot;:59,&quot;_2&quot;:51},{&quot;_1&quot;:72,&quot;_2&quot;:438},{&quot;_1&quot;:77,&quot;_2&quot;:733},{&quot;_1&quot;:71,&quot;_2&quot;:839},{&quot;_1&quot;:64,&quot;_2&quot;:46},{&quot;_1&quot;:48,&quot;_2&quot;:862}],&quot;genId&quot;:&quot;1518321038&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/scatterChart'], \n      function(playground, _magicscatterChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicscatterChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon12be15edc1406d5384817eea566d1f09\">\n      Max Points\n    </label><input id=\"input-anon12be15edc1406d5384817eea566d1f09\" type=\"number\" name=\"input-anon12be15edc1406d5384817eea566d1f09\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon12be15edc1406d5384817eea566d1f09\" data-this=\"{&quot;valueId&quot;:&quot;anon12be15edc1406d5384817eea566d1f09&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon83b091710535ac34a8a85804e3ac99d3&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anond73f3e35bc9a9319d461cf69dc410e36&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab107359769-2\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anond0decec5defe6056a12de67c8a6a2087&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:66,&quot;_2&quot;:144},{&quot;_1&quot;:53,&quot;_2&quot;:957},{&quot;_1&quot;:31,&quot;_2&quot;:279},{&quot;_1&quot;:81,&quot;_2&quot;:29},{&quot;_1&quot;:59,&quot;_2&quot;:51},{&quot;_1&quot;:72,&quot;_2&quot;:438},{&quot;_1&quot;:77,&quot;_2&quot;:733},{&quot;_1&quot;:71,&quot;_2&quot;:839},{&quot;_1&quot;:64,&quot;_2&quot;:46},{&quot;_1&quot;:48,&quot;_2&quot;:862}],&quot;genId&quot;:&quot;364886334&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/lineChart'], \n      function(playground, _magiclineChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magiclineChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anonb1b9d456b52c4033df013587d4abd28e\">\n      Max Points\n    </label><input id=\"input-anonb1b9d456b52c4033df013587d4abd28e\" type=\"number\" name=\"input-anonb1b9d456b52c4033df013587d4abd28e\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anonb1b9d456b52c4033df013587d4abd28e\" data-this=\"{&quot;valueId&quot;:&quot;anonb1b9d456b52c4033df013587d4abd28e&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon67a2cf5f629a687e7c1f029375e8c61c&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonecc7e14ead2a6aeabf9de8757d274b52&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab107359769-3\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon2d18bb0de95ca2505968d4313178789b&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:66,&quot;_2&quot;:144},{&quot;_1&quot;:53,&quot;_2&quot;:957},{&quot;_1&quot;:31,&quot;_2&quot;:279},{&quot;_1&quot;:81,&quot;_2&quot;:29},{&quot;_1&quot;:59,&quot;_2&quot;:51},{&quot;_1&quot;:72,&quot;_2&quot;:438},{&quot;_1&quot;:77,&quot;_2&quot;:733},{&quot;_1&quot;:71,&quot;_2&quot;:839},{&quot;_1&quot;:64,&quot;_2&quot;:46},{&quot;_1&quot;:48,&quot;_2&quot;:862}],&quot;genId&quot;:&quot;869368859&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/barChart'], \n      function(playground, _magicbarChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicbarChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon229699024b0174483cde3ff6b997f12f\">\n      Max Points\n    </label><input id=\"input-anon229699024b0174483cde3ff6b997f12f\" type=\"number\" name=\"input-anon229699024b0174483cde3ff6b997f12f\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon229699024b0174483cde3ff6b997f12f\" data-this=\"{&quot;valueId&quot;:&quot;anon229699024b0174483cde3ff6b997f12f&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anone0082d2da876117aabe4e6f19aa9b13d&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon81b8368fecb2c301a93ba2d0d741651e&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div></div>\n        </div>\n      </div></div>"},"output_type":"execute_result","execution_count":41}]},{"metadata":{},"cell_type":"markdown","source":"Compare the two query plans for `rddC` and `rddD`. Can you explain why the second query plan has on less shuffle phase?"},{"metadata":{},"cell_type":"markdown","source":"**See also**\n\n* http://spark.apache.org/examples.html\n* http://spark.apache.org/docs/latest/programming-guide.html\n\nAdditional info on Scala (just in case, some background may be useful to get things done, but do not get carried away - the course is about big data processing, not functional programming!)\n* Main [Scala site](http://scala-lang.org/), [tutorial](http://docs.scala-lang.org/tutorials/scala-for-java-programmers.html) and [API documentation](http://www.scala-lang.org/api/current/index.html)"}],"nbformat":4}