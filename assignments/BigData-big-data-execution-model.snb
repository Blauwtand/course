{"metadata":{"name":"big-data-execution-model","user_save_timestamp":"1970-01-01T00:00:00.000Z","auto_save_timestamp":"1970-01-01T00:00:00.000Z","language_info":{"name":"scala","file_extension":"scala","codemirror_mode":"text/x-scala"},"trusted":true,"customLocalRepo":null,"customRepos":null,"customDeps":null,"customImports":null,"customArgs":null,"customSparkConf":{"spark.app.name":"Notebook","spark.master":"local[8]","spark.executor.memory":"1G"}},"cells":[{"metadata":{},"cell_type":"markdown","source":"# Big Data: Execution Model\n\n## Deeper Understanding of Spark\n\nThe goal of this exercise is to gain a deeper understanding in what happens \"inside\"."},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"import org.apache.spark.HashPartitioner","outputs":[{"name":"stdout","output_type":"stream","text":"import org.apache.spark.HashPartitioner\n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":1}]},{"metadata":{},"cell_type":"markdown","source":"After importing additional classes not loaded by default, let us explore the specifics of how RDDs are partitioned, and how this affects the query plans that will be executed."},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rdd1 = sc.parallelize(0 to 999,8)","outputs":[{"name":"stdout","output_type":"stream","text":"rdd1: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[0] at parallelize at <console>:46\n"},{"metadata":{},"data":{"text/html":"ParallelCollectionRDD[0] at parallelize at &lt;console&gt;:46"},"output_type":"execute_result","execution_count":2}]},{"metadata":{},"cell_type":"markdown","source":"Remember that evaluation is lazy, and only happens upon actions, not transformations; i.e., so far, nothing happened.\n_Check:_ Spark UI: [jobs](http://localhost:4040/jobs/) and [stages](http://localhost:4040/stages/) are still empty. \n\n(_Note:_ Port number :4040 can be higher, e.g., :4041, depending on how many notebooks you have running in the kernel.)"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"printf( \"Number of partitions: %d\\n\", rdd1.partitions.length)\nrdd1.partitioner","outputs":[{"name":"stdout","output_type":"stream","text":"Number of partitions: 8\nres1: Option[org.apache.spark.Partitioner] = None\n"},{"metadata":{},"data":{"text/html":"None"},"output_type":"execute_result","execution_count":3}]},{"metadata":{},"cell_type":"markdown","source":"The default number of partitions depends on the number of cores in the machine that runs the docker engine; see e.g., `cat /proc/cpuinfo` from a `bash` shell in the docker engine."},{"metadata":{},"cell_type":"markdown","source":"The next command creates pairs of numbers, that we will treat as key-value pairs in the remainder of this notebook.\n\nIf you have not looked at Spark documentation so far, this would be a good time to go through the information on transformations and PairRDD functions:\n- https://spark.apache.org/docs/latest/programming-guide.html#transformations\n- https://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.rdd.PairRDDFunctions"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rddp = rdd1.map(x => (x % 100, 1000 - x))","outputs":[{"name":"stdout","output_type":"stream","text":"rddp: org.apache.spark.rdd.RDD[(Int, Int)] = MapPartitionsRDD[1] at map at <console>:47\n"},{"metadata":{},"data":{"text/html":"MapPartitionsRDD[1] at map at &lt;console&gt;:47"},"output_type":"execute_result","execution_count":4}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddp.take(15)","outputs":[{"name":"stdout","output_type":"stream","text":"res2: Array[(Int, Int)] = Array((0,1000), (1,999), (2,998), (3,997), (4,996), (5,995), (6,994), (7,993), (8,992), (9,991), (10,990), (11,989), (12,988), (13,987), (14,986))\n"},{"metadata":{},"data":{"text/html":"<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon15b3fb61f48d712e05ba3c9d470f83c7&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:1,&quot;_2&quot;:999},{&quot;_1&quot;:2,&quot;_2&quot;:998},{&quot;_1&quot;:3,&quot;_2&quot;:997},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:5,&quot;_2&quot;:995},{&quot;_1&quot;:6,&quot;_2&quot;:994},{&quot;_1&quot;:7,&quot;_2&quot;:993},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:9,&quot;_2&quot;:991},{&quot;_1&quot;:10,&quot;_2&quot;:990},{&quot;_1&quot;:11,&quot;_2&quot;:989},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:13,&quot;_2&quot;:987},{&quot;_1&quot;:14,&quot;_2&quot;:986}],&quot;genId&quot;:&quot;1452569351&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anonb30b79dfcc19cfad9ce9ec461b3a0f6b\">\n      Max Points (controlling all tabs)\n    </label><input id=\"input-anonb30b79dfcc19cfad9ce9ec461b3a0f6b\" type=\"number\" name=\"input-anonb30b79dfcc19cfad9ce9ec461b3a0f6b\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anonb30b79dfcc19cfad9ce9ec461b3a0f6b\" data-this=\"{&quot;valueId&quot;:&quot;anonb30b79dfcc19cfad9ce9ec461b3a0f6b&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <div>\n          <ul class=\"nav nav-tabs\" id=\"ul1452569351\"><li>\n                <a href=\"#tab1452569351-0\"><i class=\"fa fa-table\"/></a>\n              </li><li>\n                <a href=\"#tab1452569351-1\"><i class=\"fa fa-dot-circle-o\"/></a>\n              </li><li>\n                <a href=\"#tab1452569351-2\"><i class=\"fa fa-line-chart\"/></a>\n              </li><li>\n                <a href=\"#tab1452569351-3\"><i class=\"fa fa-bar-chart\"/></a>\n              </li></ul>\n\n          <div class=\"tab-content\" id=\"tab1452569351\"><div class=\"tab-pane\" id=\"tab1452569351-0\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anone8267d8cf4e9ade344f030bd4cb480cb&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:1,&quot;_2&quot;:999},{&quot;_1&quot;:2,&quot;_2&quot;:998},{&quot;_1&quot;:3,&quot;_2&quot;:997},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:5,&quot;_2&quot;:995},{&quot;_1&quot;:6,&quot;_2&quot;:994},{&quot;_1&quot;:7,&quot;_2&quot;:993},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:9,&quot;_2&quot;:991},{&quot;_1&quot;:10,&quot;_2&quot;:990},{&quot;_1&quot;:11,&quot;_2&quot;:989},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:13,&quot;_2&quot;:987},{&quot;_1&quot;:14,&quot;_2&quot;:986}],&quot;genId&quot;:&quot;1823046911&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon6d900ed0de42c9453be2da0bcd6d4c4c\">\n      Max Points\n    </label><input id=\"input-anon6d900ed0de42c9453be2da0bcd6d4c4c\" type=\"number\" name=\"input-anon6d900ed0de42c9453be2da0bcd6d4c4c\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon6d900ed0de42c9453be2da0bcd6d4c4c\" data-this=\"{&quot;valueId&quot;:&quot;anon6d900ed0de42c9453be2da0bcd6d4c4c&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon46fe293d2ce3acc56a175d6717b9bb99&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon8d430cf2063b321a3157349a2331a34c&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab1452569351-1\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anonb84bdb185b59e3efb687c06d66b2b08a&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:1,&quot;_2&quot;:999},{&quot;_1&quot;:2,&quot;_2&quot;:998},{&quot;_1&quot;:3,&quot;_2&quot;:997},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:5,&quot;_2&quot;:995},{&quot;_1&quot;:6,&quot;_2&quot;:994},{&quot;_1&quot;:7,&quot;_2&quot;:993},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:9,&quot;_2&quot;:991},{&quot;_1&quot;:10,&quot;_2&quot;:990},{&quot;_1&quot;:11,&quot;_2&quot;:989},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:13,&quot;_2&quot;:987},{&quot;_1&quot;:14,&quot;_2&quot;:986}],&quot;genId&quot;:&quot;1194094564&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/scatterChart'], \n      function(playground, _magicscatterChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicscatterChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anoncd3ef99de68df5252b9f4fed9645a80e\">\n      Max Points\n    </label><input id=\"input-anoncd3ef99de68df5252b9f4fed9645a80e\" type=\"number\" name=\"input-anoncd3ef99de68df5252b9f4fed9645a80e\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anoncd3ef99de68df5252b9f4fed9645a80e\" data-this=\"{&quot;valueId&quot;:&quot;anoncd3ef99de68df5252b9f4fed9645a80e&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonc7fa2e45d63709b965b0c1a824fe0c86&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anoned8686571e1aee9ce30abc2362bfb603&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab1452569351-2\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon9807702564dd0e64d11da6c83a7808a0&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:1,&quot;_2&quot;:999},{&quot;_1&quot;:2,&quot;_2&quot;:998},{&quot;_1&quot;:3,&quot;_2&quot;:997},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:5,&quot;_2&quot;:995},{&quot;_1&quot;:6,&quot;_2&quot;:994},{&quot;_1&quot;:7,&quot;_2&quot;:993},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:9,&quot;_2&quot;:991},{&quot;_1&quot;:10,&quot;_2&quot;:990},{&quot;_1&quot;:11,&quot;_2&quot;:989},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:13,&quot;_2&quot;:987},{&quot;_1&quot;:14,&quot;_2&quot;:986}],&quot;genId&quot;:&quot;1921978839&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/lineChart'], \n      function(playground, _magiclineChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magiclineChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon8707d3fc43e9f4a9419b039248a9a8aa\">\n      Max Points\n    </label><input id=\"input-anon8707d3fc43e9f4a9419b039248a9a8aa\" type=\"number\" name=\"input-anon8707d3fc43e9f4a9419b039248a9a8aa\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon8707d3fc43e9f4a9419b039248a9a8aa\" data-this=\"{&quot;valueId&quot;:&quot;anon8707d3fc43e9f4a9419b039248a9a8aa&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon29cb8224126e2193877f13309b35741e&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anoncda4f66b4af0a654af5645cd1980d52d&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab1452569351-3\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anonf9e968a529221fcad8ca3d059bf0a2bc&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:1,&quot;_2&quot;:999},{&quot;_1&quot;:2,&quot;_2&quot;:998},{&quot;_1&quot;:3,&quot;_2&quot;:997},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:5,&quot;_2&quot;:995},{&quot;_1&quot;:6,&quot;_2&quot;:994},{&quot;_1&quot;:7,&quot;_2&quot;:993},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:9,&quot;_2&quot;:991},{&quot;_1&quot;:10,&quot;_2&quot;:990},{&quot;_1&quot;:11,&quot;_2&quot;:989},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:13,&quot;_2&quot;:987},{&quot;_1&quot;:14,&quot;_2&quot;:986}],&quot;genId&quot;:&quot;1531196376&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/barChart'], \n      function(playground, _magicbarChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicbarChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon5ac15b1bff7f294efdc314c67c32ee55\">\n      Max Points\n    </label><input id=\"input-anon5ac15b1bff7f294efdc314c67c32ee55\" type=\"number\" name=\"input-anon5ac15b1bff7f294efdc314c67c32ee55\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon5ac15b1bff7f294efdc314c67c32ee55\" data-this=\"{&quot;valueId&quot;:&quot;anon5ac15b1bff7f294efdc314c67c32ee55&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonc35a1c628c0442c25e2aac7be53d0036&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon13bc94161f5853887c692903e3aa3603&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div></div>\n        </div>\n      </div></div>"},"output_type":"execute_result","execution_count":5}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddp.partitioner","outputs":[{"name":"stdout","output_type":"stream","text":"res3: Option[org.apache.spark.Partitioner] = None\n"},{"metadata":{},"data":{"text/html":"None"},"output_type":"execute_result","execution_count":6}]},{"metadata":{},"cell_type":"markdown","source":"As we see, the default way of processing does not assign a partitioner; the framework partitions the data in the default way, which is merely a guess. Several ways influence how partitioning takes place, where the easiest is to assign a partitioner."},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rddpp = rddp.partitionBy(new HashPartitioner(2))","outputs":[{"name":"stdout","output_type":"stream","text":"rddpp: org.apache.spark.rdd.RDD[(Int, Int)] = ShuffledRDD[2] at partitionBy at <console>:48\n"},{"metadata":{},"data":{"text/html":"ShuffledRDD[2] at partitionBy at &lt;console&gt;:48"},"output_type":"execute_result","execution_count":7}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddpp.partitioner","outputs":[{"name":"stdout","output_type":"stream","text":"res4: Option[org.apache.spark.Partitioner] = Some(org.apache.spark.HashPartitioner@2)\n"},{"metadata":{},"data":{"text/html":"Some(org.apache.spark.HashPartitioner@2)"},"output_type":"execute_result","execution_count":8}]},{"metadata":{},"cell_type":"markdown","source":"See how that influences processing; notice that `rddp` is partitioned in the default way, whereas `rddpp` uses only two partitions, based on our instructions."},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rddpg = rddp.groupByKey()","outputs":[{"name":"stdout","output_type":"stream","text":"rddpg: org.apache.spark.rdd.RDD[(Int, Iterable[Int])] = ShuffledRDD[3] at groupByKey at <console>:48\n"},{"metadata":{},"data":{"text/html":"ShuffledRDD[3] at groupByKey at &lt;console&gt;:48"},"output_type":"execute_result","execution_count":9}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddpg.toDebugString","outputs":[{"name":"stdout","output_type":"stream","text":"res5: String =\n(8) ShuffledRDD[3] at groupByKey at <console>:48 []\n +-(8) MapPartitionsRDD[1] at map at <console>:47 []\n    |  ParallelCollectionRDD[0] at parallelize at <console>:46 []\n"},{"metadata":{},"data":{"text/html":"(8) ShuffledRDD[3] at groupByKey at &lt;console&gt;:48 []\n +-(8) MapPartitionsRDD[1] at map at &lt;console&gt;:47 []\n    |  ParallelCollectionRDD[0] at parallelize at &lt;console&gt;:46 []"},"output_type":"execute_result","execution_count":10}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddpg.partitioner","outputs":[{"name":"stdout","output_type":"stream","text":"res6: Option[org.apache.spark.Partitioner] = Some(org.apache.spark.HashPartitioner@8)\n"},{"metadata":{},"data":{"text/html":"Some(org.apache.spark.HashPartitioner@8)"},"output_type":"execute_result","execution_count":11}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddpg.partitions.map(p => (p, p.index, p.hashCode))","outputs":[{"name":"stdout","output_type":"stream","text":"res7: Array[(org.apache.spark.Partition, Int, Int)] = Array((org.apache.spark.rdd.ShuffledRDDPartition@0,0,0), (org.apache.spark.rdd.ShuffledRDDPartition@1,1,1), (org.apache.spark.rdd.ShuffledRDDPartition@2,2,2), (org.apache.spark.rdd.ShuffledRDDPartition@3,3,3), (org.apache.spark.rdd.ShuffledRDDPartition@4,4,4), (org.apache.spark.rdd.ShuffledRDDPartition@5,5,5), (org.apache.spark.rdd.ShuffledRDDPartition@6,6,6), (org.apache.spark.rdd.ShuffledRDDPartition@7,7,7))\n"},{"metadata":{},"data":{"text/html":"<div class=\"container-fluid\"><div><div class=\"col-md-12\"><div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon8d6d92592a3c46a48e9db74fa876f9b8&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@0&quot;,&quot;_2&quot;:0,&quot;_3&quot;:0},{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@1&quot;,&quot;_2&quot;:1,&quot;_3&quot;:1},{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@2&quot;,&quot;_2&quot;:2,&quot;_3&quot;:2},{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@3&quot;,&quot;_2&quot;:3,&quot;_3&quot;:3},{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@4&quot;,&quot;_2&quot;:4,&quot;_3&quot;:4},{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@5&quot;,&quot;_2&quot;:5,&quot;_3&quot;:5},{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@6&quot;,&quot;_2&quot;:6,&quot;_3&quot;:6},{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@7&quot;,&quot;_2&quot;:7,&quot;_3&quot;:7}],&quot;genId&quot;:&quot;1107352017&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\",\"_3\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anond6a833ebe9e9e94092e5f55f5ac6b6d9\">\n      Max Points\n    </label><input id=\"input-anond6a833ebe9e9e94092e5f55f5ac6b6d9\" type=\"number\" name=\"input-anond6a833ebe9e9e94092e5f55f5ac6b6d9\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anond6a833ebe9e9e94092e5f55f5ac6b6d9\" data-this=\"{&quot;valueId&quot;:&quot;anond6a833ebe9e9e94092e5f55f5ac6b6d9&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonfc2b5a50e2181a988aef813932b1a920&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon6447939a6148b7bde8a14b9e377ec63a&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div></div></div></div>"},"output_type":"execute_result","execution_count":12}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rddppg = rddpp.groupByKey()","outputs":[{"name":"stdout","output_type":"stream","text":"rddppg: org.apache.spark.rdd.RDD[(Int, Iterable[Int])] = MapPartitionsRDD[4] at groupByKey at <console>:49\n"},{"metadata":{},"data":{"text/html":"MapPartitionsRDD[4] at groupByKey at &lt;console&gt;:49"},"output_type":"execute_result","execution_count":13}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddppg.partitioner","outputs":[{"name":"stdout","output_type":"stream","text":"res8: Option[org.apache.spark.Partitioner] = Some(org.apache.spark.HashPartitioner@2)\n"},{"metadata":{},"data":{"text/html":"Some(org.apache.spark.HashPartitioner@2)"},"output_type":"execute_result","execution_count":14}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddppg.partitions.map(p => (p, p.index, p.hashCode))","outputs":[{"name":"stdout","output_type":"stream","text":"res9: Array[(org.apache.spark.Partition, Int, Int)] = Array((org.apache.spark.rdd.ShuffledRDDPartition@0,0,0), (org.apache.spark.rdd.ShuffledRDDPartition@1,1,1))\n"},{"metadata":{},"data":{"text/html":"<div class=\"container-fluid\"><div><div class=\"col-md-12\"><div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon498e8818e9f4aeabf0e7dcdaa102d227&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@0&quot;,&quot;_2&quot;:0,&quot;_3&quot;:0},{&quot;_1&quot;:&quot;org.apache.spark.rdd.ShuffledRDDPartition@1&quot;,&quot;_2&quot;:1,&quot;_3&quot;:1}],&quot;genId&quot;:&quot;882781033&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\",\"_3\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anonb6283c5a8d5eb34892e856651c897653\">\n      Max Points\n    </label><input id=\"input-anonb6283c5a8d5eb34892e856651c897653\" type=\"number\" name=\"input-anonb6283c5a8d5eb34892e856651c897653\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anonb6283c5a8d5eb34892e856651c897653\" data-this=\"{&quot;valueId&quot;:&quot;anonb6283c5a8d5eb34892e856651c897653&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon77064eccce762b77f642a996403057be&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anond4242df3142743efda43fcd16f786b91&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div></div></div></div>"},"output_type":"execute_result","execution_count":15}]},{"metadata":{},"cell_type":"markdown","source":"Observe how the number of partitions of a groupByKey operation varies depending on the way the input is partitioned. This in turn affects the number of machines that will be at work in subsequent operations. Take a look at the Spark UI to see the difference for the two cases.\n\n_Note: using explicit naming of RDDs helps you keep track of which job corresponds to which case._"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val pgc2 = rddppg.map( {case(x,y) => (x, y.reduce((a,b) => a + b))} )","outputs":[{"name":"stdout","output_type":"stream","text":"pgc2: org.apache.spark.rdd.RDD[(Int, Int)] = MapPartitionsRDD[5] at map at <console>:50\n"},{"metadata":{},"data":{"text/html":"MapPartitionsRDD[5] at map at &lt;console&gt;:50"},"output_type":"execute_result","execution_count":16}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"pgc2.name = \"Partitioned Group Counts (2)\"","outputs":[{"name":"stdout","output_type":"stream","text":"pgc2.name: String = Partitioned Group Counts (2)\n"},{"metadata":{},"data":{"text/html":"Partitioned Group Counts (2)"},"output_type":"execute_result","execution_count":17}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"pgc2.take(10)","outputs":[{"name":"stdout","output_type":"stream","text":"res10: Array[(Int, Int)] = Array((34,5160), (52,4980), (96,4540), (4,5460), (16,5340), (82,4680), (66,4840), (28,5220), (54,4960), (80,4700))\n"},{"metadata":{},"data":{"text/html":"<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon00ab43062a7eadb624463ef69eac72a1&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:34,&quot;_2&quot;:5160},{&quot;_1&quot;:52,&quot;_2&quot;:4980},{&quot;_1&quot;:96,&quot;_2&quot;:4540},{&quot;_1&quot;:4,&quot;_2&quot;:5460},{&quot;_1&quot;:16,&quot;_2&quot;:5340},{&quot;_1&quot;:82,&quot;_2&quot;:4680},{&quot;_1&quot;:66,&quot;_2&quot;:4840},{&quot;_1&quot;:28,&quot;_2&quot;:5220},{&quot;_1&quot;:54,&quot;_2&quot;:4960},{&quot;_1&quot;:80,&quot;_2&quot;:4700}],&quot;genId&quot;:&quot;1040263396&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon832fb3e9ad033a76ead8cc48097b6903\">\n      Max Points (controlling all tabs)\n    </label><input id=\"input-anon832fb3e9ad033a76ead8cc48097b6903\" type=\"number\" name=\"input-anon832fb3e9ad033a76ead8cc48097b6903\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon832fb3e9ad033a76ead8cc48097b6903\" data-this=\"{&quot;valueId&quot;:&quot;anon832fb3e9ad033a76ead8cc48097b6903&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <div>\n          <ul class=\"nav nav-tabs\" id=\"ul1040263396\"><li>\n                <a href=\"#tab1040263396-0\"><i class=\"fa fa-table\"/></a>\n              </li><li>\n                <a href=\"#tab1040263396-1\"><i class=\"fa fa-dot-circle-o\"/></a>\n              </li><li>\n                <a href=\"#tab1040263396-2\"><i class=\"fa fa-line-chart\"/></a>\n              </li><li>\n                <a href=\"#tab1040263396-3\"><i class=\"fa fa-bar-chart\"/></a>\n              </li></ul>\n\n          <div class=\"tab-content\" id=\"tab1040263396\"><div class=\"tab-pane\" id=\"tab1040263396-0\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon6c6dc7291a12131bacd47cbf01560ab6&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:34,&quot;_2&quot;:5160},{&quot;_1&quot;:52,&quot;_2&quot;:4980},{&quot;_1&quot;:96,&quot;_2&quot;:4540},{&quot;_1&quot;:4,&quot;_2&quot;:5460},{&quot;_1&quot;:16,&quot;_2&quot;:5340},{&quot;_1&quot;:82,&quot;_2&quot;:4680},{&quot;_1&quot;:66,&quot;_2&quot;:4840},{&quot;_1&quot;:28,&quot;_2&quot;:5220},{&quot;_1&quot;:54,&quot;_2&quot;:4960},{&quot;_1&quot;:80,&quot;_2&quot;:4700}],&quot;genId&quot;:&quot;1959284108&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anonaf2871c7e42afb6615907a0411165e19\">\n      Max Points\n    </label><input id=\"input-anonaf2871c7e42afb6615907a0411165e19\" type=\"number\" name=\"input-anonaf2871c7e42afb6615907a0411165e19\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anonaf2871c7e42afb6615907a0411165e19\" data-this=\"{&quot;valueId&quot;:&quot;anonaf2871c7e42afb6615907a0411165e19&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anone7d0a6bb673d5c57bf51fd820755f768&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon591b83e8d935b4337097e94122cef5df&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab1040263396-1\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon0c9ff3fb705b995a1d60d619647d6d90&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:34,&quot;_2&quot;:5160},{&quot;_1&quot;:52,&quot;_2&quot;:4980},{&quot;_1&quot;:96,&quot;_2&quot;:4540},{&quot;_1&quot;:4,&quot;_2&quot;:5460},{&quot;_1&quot;:16,&quot;_2&quot;:5340},{&quot;_1&quot;:82,&quot;_2&quot;:4680},{&quot;_1&quot;:66,&quot;_2&quot;:4840},{&quot;_1&quot;:28,&quot;_2&quot;:5220},{&quot;_1&quot;:54,&quot;_2&quot;:4960},{&quot;_1&quot;:80,&quot;_2&quot;:4700}],&quot;genId&quot;:&quot;788192730&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/scatterChart'], \n      function(playground, _magicscatterChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicscatterChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon66d9b9fd96fa8d30b4be8ab5e935ba79\">\n      Max Points\n    </label><input id=\"input-anon66d9b9fd96fa8d30b4be8ab5e935ba79\" type=\"number\" name=\"input-anon66d9b9fd96fa8d30b4be8ab5e935ba79\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon66d9b9fd96fa8d30b4be8ab5e935ba79\" data-this=\"{&quot;valueId&quot;:&quot;anon66d9b9fd96fa8d30b4be8ab5e935ba79&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon91613b84207eef00682a15c984630707&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon7e9a2eb0a563a73dd97e14f222282e15&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab1040263396-2\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon8e8214fb86ff58def931ddeed88065ac&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:34,&quot;_2&quot;:5160},{&quot;_1&quot;:52,&quot;_2&quot;:4980},{&quot;_1&quot;:96,&quot;_2&quot;:4540},{&quot;_1&quot;:4,&quot;_2&quot;:5460},{&quot;_1&quot;:16,&quot;_2&quot;:5340},{&quot;_1&quot;:82,&quot;_2&quot;:4680},{&quot;_1&quot;:66,&quot;_2&quot;:4840},{&quot;_1&quot;:28,&quot;_2&quot;:5220},{&quot;_1&quot;:54,&quot;_2&quot;:4960},{&quot;_1&quot;:80,&quot;_2&quot;:4700}],&quot;genId&quot;:&quot;1648226170&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/lineChart'], \n      function(playground, _magiclineChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magiclineChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon0e86b26376d1d098fec990d57b12311b\">\n      Max Points\n    </label><input id=\"input-anon0e86b26376d1d098fec990d57b12311b\" type=\"number\" name=\"input-anon0e86b26376d1d098fec990d57b12311b\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon0e86b26376d1d098fec990d57b12311b\" data-this=\"{&quot;valueId&quot;:&quot;anon0e86b26376d1d098fec990d57b12311b&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonfbe5e878b912b0535add674865f84743&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonc1ba187578214bc41370a1d435603674&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab1040263396-3\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon61bdf81f54d44d05b064a51c5a09e650&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:34,&quot;_2&quot;:5160},{&quot;_1&quot;:52,&quot;_2&quot;:4980},{&quot;_1&quot;:96,&quot;_2&quot;:4540},{&quot;_1&quot;:4,&quot;_2&quot;:5460},{&quot;_1&quot;:16,&quot;_2&quot;:5340},{&quot;_1&quot;:82,&quot;_2&quot;:4680},{&quot;_1&quot;:66,&quot;_2&quot;:4840},{&quot;_1&quot;:28,&quot;_2&quot;:5220},{&quot;_1&quot;:54,&quot;_2&quot;:4960},{&quot;_1&quot;:80,&quot;_2&quot;:4700}],&quot;genId&quot;:&quot;1579850798&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/barChart'], \n      function(playground, _magicbarChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicbarChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon72fd05a8317e964dd2020ef5c41ac8ab\">\n      Max Points\n    </label><input id=\"input-anon72fd05a8317e964dd2020ef5c41ac8ab\" type=\"number\" name=\"input-anon72fd05a8317e964dd2020ef5c41ac8ab\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon72fd05a8317e964dd2020ef5c41ac8ab\" data-this=\"{&quot;valueId&quot;:&quot;anon72fd05a8317e964dd2020ef5c41ac8ab&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon299ed34eea4cf8fbab05e99fee14b972&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon2ccb2a4e5e3a35a7d8323f2ff400c630&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div></div>\n        </div>\n      </div></div>"},"output_type":"execute_result","execution_count":18}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"pgc2.partitions.size","outputs":[{"name":"stdout","output_type":"stream","text":"res11: Int = 2\n"},{"metadata":{},"data":{"text/html":"2"},"output_type":"execute_result","execution_count":19}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"pgc2.toDebugString","outputs":[{"name":"stdout","output_type":"stream","text":"res12: String =\n(2) Partitioned Group Counts (2) MapPartitionsRDD[5] at map at <console>:50 []\n |  MapPartitionsRDD[4] at groupByKey at <console>:49 []\n |  ShuffledRDD[2] at partitionBy at <console>:48 []\n +-(8) MapPartitionsRDD[1] at map at <console>:47 []\n    |  ParallelCollectionRDD[0] at parallelize at <console>:46 []\n"},{"metadata":{},"data":{"text/html":"(2) Partitioned Group Counts (2) MapPartitionsRDD[5] at map at &lt;console&gt;:50 []\n |  MapPartitionsRDD[4] at groupByKey at &lt;console&gt;:49 []\n |  ShuffledRDD[2] at partitionBy at &lt;console&gt;:48 []\n +-(8) MapPartitionsRDD[1] at map at &lt;console&gt;:47 []\n    |  ParallelCollectionRDD[0] at parallelize at &lt;console&gt;:46 []"},"output_type":"execute_result","execution_count":20}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"pgc2.partitioner","outputs":[{"name":"stdout","output_type":"stream","text":"res13: Option[org.apache.spark.Partitioner] = None\n"},{"metadata":{},"data":{"text/html":"None"},"output_type":"execute_result","execution_count":21}]},{"metadata":{},"cell_type":"markdown","source":"_Q: do you understand why the partitioner is none? (No worries if not, you will find a clue below.)_"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rddp4 = rddp.partitionBy(new HashPartitioner(4))","outputs":[{"name":"stdout","output_type":"stream","text":"rddp4: org.apache.spark.rdd.RDD[(Int, Int)] = ShuffledRDD[7] at partitionBy at <console>:48\n"},{"metadata":{},"data":{"text/html":"ShuffledRDD[7] at partitionBy at &lt;console&gt;:48"},"output_type":"execute_result","execution_count":26}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddp4.partitioner","outputs":[{"name":"stdout","output_type":"stream","text":"res17: Option[org.apache.spark.Partitioner] = Some(org.apache.spark.HashPartitioner@4)\n"},{"metadata":{},"data":{"text/html":"Some(org.apache.spark.HashPartitioner@4)"},"output_type":"execute_result","execution_count":27}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddp4.take(10)","outputs":[{"name":"stdout","output_type":"stream","text":"res18: Array[(Int, Int)] = Array((0,1000), (4,996), (8,992), (12,988), (16,984), (20,980), (24,976), (28,972), (32,968), (36,964))\n"},{"metadata":{},"data":{"text/html":"<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon0768344f9f6abefc5eb10e5d08054936&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:16,&quot;_2&quot;:984},{&quot;_1&quot;:20,&quot;_2&quot;:980},{&quot;_1&quot;:24,&quot;_2&quot;:976},{&quot;_1&quot;:28,&quot;_2&quot;:972},{&quot;_1&quot;:32,&quot;_2&quot;:968},{&quot;_1&quot;:36,&quot;_2&quot;:964}],&quot;genId&quot;:&quot;56562566&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anonc244eede35344be4585e40b4985a5904\">\n      Max Points (controlling all tabs)\n    </label><input id=\"input-anonc244eede35344be4585e40b4985a5904\" type=\"number\" name=\"input-anonc244eede35344be4585e40b4985a5904\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anonc244eede35344be4585e40b4985a5904\" data-this=\"{&quot;valueId&quot;:&quot;anonc244eede35344be4585e40b4985a5904&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <div>\n          <ul class=\"nav nav-tabs\" id=\"ul56562566\"><li>\n                <a href=\"#tab56562566-0\"><i class=\"fa fa-table\"/></a>\n              </li><li>\n                <a href=\"#tab56562566-1\"><i class=\"fa fa-dot-circle-o\"/></a>\n              </li><li>\n                <a href=\"#tab56562566-2\"><i class=\"fa fa-line-chart\"/></a>\n              </li><li>\n                <a href=\"#tab56562566-3\"><i class=\"fa fa-bar-chart\"/></a>\n              </li></ul>\n\n          <div class=\"tab-content\" id=\"tab56562566\"><div class=\"tab-pane\" id=\"tab56562566-0\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon5c6991b0671a9840da8dc073979792cb&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:16,&quot;_2&quot;:984},{&quot;_1&quot;:20,&quot;_2&quot;:980},{&quot;_1&quot;:24,&quot;_2&quot;:976},{&quot;_1&quot;:28,&quot;_2&quot;:972},{&quot;_1&quot;:32,&quot;_2&quot;:968},{&quot;_1&quot;:36,&quot;_2&quot;:964}],&quot;genId&quot;:&quot;690537122&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anonbdc3c6f7f6389c2f7eac0ad9cda82a01\">\n      Max Points\n    </label><input id=\"input-anonbdc3c6f7f6389c2f7eac0ad9cda82a01\" type=\"number\" name=\"input-anonbdc3c6f7f6389c2f7eac0ad9cda82a01\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anonbdc3c6f7f6389c2f7eac0ad9cda82a01\" data-this=\"{&quot;valueId&quot;:&quot;anonbdc3c6f7f6389c2f7eac0ad9cda82a01&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon9d8f7c7151867cf00cdd4deb00984599&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonbc777e95ebd0d595b47d714921317a87&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab56562566-1\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anona4447cbfb4cca8c6fd9772a8742be490&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:16,&quot;_2&quot;:984},{&quot;_1&quot;:20,&quot;_2&quot;:980},{&quot;_1&quot;:24,&quot;_2&quot;:976},{&quot;_1&quot;:28,&quot;_2&quot;:972},{&quot;_1&quot;:32,&quot;_2&quot;:968},{&quot;_1&quot;:36,&quot;_2&quot;:964}],&quot;genId&quot;:&quot;363157595&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/scatterChart'], \n      function(playground, _magicscatterChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicscatterChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon8019c04a6561150e85735cd01ba096a0\">\n      Max Points\n    </label><input id=\"input-anon8019c04a6561150e85735cd01ba096a0\" type=\"number\" name=\"input-anon8019c04a6561150e85735cd01ba096a0\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon8019c04a6561150e85735cd01ba096a0\" data-this=\"{&quot;valueId&quot;:&quot;anon8019c04a6561150e85735cd01ba096a0&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonf03d17a4779539d03d36664b2942ed1d&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon1725da32ff575eb9910a281269479c66&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab56562566-2\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon489e1ea17a435313a39a86f48bc31692&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:16,&quot;_2&quot;:984},{&quot;_1&quot;:20,&quot;_2&quot;:980},{&quot;_1&quot;:24,&quot;_2&quot;:976},{&quot;_1&quot;:28,&quot;_2&quot;:972},{&quot;_1&quot;:32,&quot;_2&quot;:968},{&quot;_1&quot;:36,&quot;_2&quot;:964}],&quot;genId&quot;:&quot;1610592254&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/lineChart'], \n      function(playground, _magiclineChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magiclineChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon4d2344181316b01d7e86a6b3a59910c2\">\n      Max Points\n    </label><input id=\"input-anon4d2344181316b01d7e86a6b3a59910c2\" type=\"number\" name=\"input-anon4d2344181316b01d7e86a6b3a59910c2\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon4d2344181316b01d7e86a6b3a59910c2\" data-this=\"{&quot;valueId&quot;:&quot;anon4d2344181316b01d7e86a6b3a59910c2&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon0dabe00ec612314467feb7e57d527030&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonedea24e4dead81bac3685092557c0026&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab56562566-3\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anone2d2c8fbc7bd4ab59499d6c9e8475c5a&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:1000},{&quot;_1&quot;:4,&quot;_2&quot;:996},{&quot;_1&quot;:8,&quot;_2&quot;:992},{&quot;_1&quot;:12,&quot;_2&quot;:988},{&quot;_1&quot;:16,&quot;_2&quot;:984},{&quot;_1&quot;:20,&quot;_2&quot;:980},{&quot;_1&quot;:24,&quot;_2&quot;:976},{&quot;_1&quot;:28,&quot;_2&quot;:972},{&quot;_1&quot;:32,&quot;_2&quot;:968},{&quot;_1&quot;:36,&quot;_2&quot;:964}],&quot;genId&quot;:&quot;835712447&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/barChart'], \n      function(playground, _magicbarChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicbarChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon94ab0796d251e1524258609781409ce1\">\n      Max Points\n    </label><input id=\"input-anon94ab0796d251e1524258609781409ce1\" type=\"number\" name=\"input-anon94ab0796d251e1524258609781409ce1\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon94ab0796d251e1524258609781409ce1\" data-this=\"{&quot;valueId&quot;:&quot;anon94ab0796d251e1524258609781409ce1&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonb7450b11daf33512fdf730929f6406a9&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon81b0b6cb1dac2ec1571eea6df642ca82&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div></div>\n        </div>\n      </div></div>"},"output_type":"execute_result","execution_count":28}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rddA = rddp4.values.map( x => x  + 10 )","outputs":[{"name":"stdout","output_type":"stream","text":"rddA: org.apache.spark.rdd.RDD[Int] = MapPartitionsRDD[9] at map at <console>:49\n"},{"metadata":{},"data":{"text/html":"MapPartitionsRDD[9] at map at &lt;console&gt;:49"},"output_type":"execute_result","execution_count":29}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddA.partitioner","outputs":[{"name":"stdout","output_type":"stream","text":"res19: Option[org.apache.spark.Partitioner] = None\n"},{"metadata":{},"data":{"text/html":"None"},"output_type":"execute_result","execution_count":30}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rddB = rddp4.mapValues( x => x + 10 )","outputs":[{"name":"stdout","output_type":"stream","text":"rddB: org.apache.spark.rdd.RDD[(Int, Int)] = MapPartitionsRDD[10] at mapValues at <console>:49\n"},{"metadata":{},"data":{"text/html":"MapPartitionsRDD[10] at mapValues at &lt;console&gt;:49"},"output_type":"execute_result","execution_count":31}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddB.partitioner","outputs":[{"name":"stdout","output_type":"stream","text":"res20: Option[org.apache.spark.Partitioner] = Some(org.apache.spark.HashPartitioner@4)\n"},{"metadata":{},"data":{"text/html":"Some(org.apache.spark.HashPartitioner@4)"},"output_type":"execute_result","execution_count":32}]},{"metadata":{},"cell_type":"markdown","source":"Summarizing: partitioning depends on the distributed operations that are executed, and only operations with guarantees about the output distribution will carry an existing partitioner over to its result.\n\nAnother way to control the level of parallellism during query execution is to use the `repartition` and `coalesce` operations. "},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rddC = rddA.repartition(2)","outputs":[{"name":"stdout","output_type":"stream","text":"rddC: org.apache.spark.rdd.RDD[Int] = MapPartitionsRDD[14] at repartition at <console>:50\n"},{"metadata":{},"data":{"text/html":"MapPartitionsRDD[14] at repartition at &lt;console&gt;:50"},"output_type":"execute_result","execution_count":33}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddC.partitions.map(p => (p, p.index, p.hashCode))","outputs":[{"name":"stdout","output_type":"stream","text":"res21: Array[(org.apache.spark.Partition, Int, Int)] = Array((CoalescedRDDPartition(0,ShuffledRDD[12] at repartition at <console>:50,[I@38bc8639,None),0,0), (CoalescedRDDPartition(1,ShuffledRDD[12] at repartition at <console>:50,[I@61102548,None),1,1))\n"},{"metadata":{},"data":{"text/html":"<div class=\"container-fluid\"><div><div class=\"col-md-12\"><div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon95f91737b950b365280b6493036e24ce&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;CoalescedRDDPartition(0,ShuffledRDD[12] at repartition at &lt;console&gt;:50,[I@38bc8639,None)&quot;,&quot;_2&quot;:0,&quot;_3&quot;:0},{&quot;_1&quot;:&quot;CoalescedRDDPartition(1,ShuffledRDD[12] at repartition at &lt;console&gt;:50,[I@61102548,None)&quot;,&quot;_2&quot;:1,&quot;_3&quot;:1}],&quot;genId&quot;:&quot;2051287305&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\",\"_3\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anonb448edea601451dcc91e588fa8483ee4\">\n      Max Points\n    </label><input id=\"input-anonb448edea601451dcc91e588fa8483ee4\" type=\"number\" name=\"input-anonb448edea601451dcc91e588fa8483ee4\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anonb448edea601451dcc91e588fa8483ee4\" data-this=\"{&quot;valueId&quot;:&quot;anonb448edea601451dcc91e588fa8483ee4&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon714265e49547ed9997679d1877f86a99&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon4983a1c32474485810a76ceb81c0d5fa&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div></div></div></div>"},"output_type":"execute_result","execution_count":34}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddC.toDebugString","outputs":[{"name":"stdout","output_type":"stream","text":"res22: String =\n(2) MapPartitionsRDD[14] at repartition at <console>:50 []\n |  CoalescedRDD[13] at repartition at <console>:50 []\n |  ShuffledRDD[12] at repartition at <console>:50 []\n +-(4) MapPartitionsRDD[11] at repartition at <console>:50 []\n    |  MapPartitionsRDD[9] at map at <console>:49 []\n    |  MapPartitionsRDD[8] at values at <console>:49 []\n    |  ShuffledRDD[7] at partitionBy at <console>:48 []\n    +-(8) MapPartitionsRDD[1] at map at <console>:47 []\n       |  ParallelCollectionRDD[0] at parallelize at <console>:46 []\n"},{"metadata":{},"data":{"text/html":"(2) MapPartitionsRDD[14] at repartition at &lt;console&gt;:50 []\n |  CoalescedRDD[13] at repartition at &lt;console&gt;:50 []\n |  ShuffledRDD[12] at repartition at &lt;console&gt;:50 []\n +-(4) MapPartitionsRDD[11] at repartition at &lt;console&gt;:50 []\n    |  MapPartitionsRDD[9] at map at &lt;console&gt;:49 []\n    |  MapPartitionsRDD[8] at values at &lt;console&gt;:49 []\n    |  ShuffledRDD[7] at partitionBy at &lt;console&gt;:48 []\n    +-(8) MapPartitionsRDD[1] at map at &lt;console&gt;:47 []\n       |  ParallelCollectionRDD[0] at parallelize at &lt;console&gt;:46 []"},"output_type":"execute_result","execution_count":35}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val rddD = rddB.coalesce(2)","outputs":[{"name":"stdout","output_type":"stream","text":"rddD: org.apache.spark.rdd.RDD[(Int, Int)] = CoalescedRDD[15] at coalesce at <console>:50\n"},{"metadata":{},"data":{"text/html":"CoalescedRDD[15] at coalesce at &lt;console&gt;:50"},"output_type":"execute_result","execution_count":36}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"rddD.toDebugString","outputs":[{"name":"stdout","output_type":"stream","text":"res23: String =\n(2) CoalescedRDD[15] at coalesce at <console>:50 []\n |  MapPartitionsRDD[10] at mapValues at <console>:49 []\n |  ShuffledRDD[7] at partitionBy at <console>:48 []\n +-(8) MapPartitionsRDD[1] at map at <console>:47 []\n    |  ParallelCollectionRDD[0] at parallelize at <console>:46 []\n"},{"metadata":{},"data":{"text/html":"(2) CoalescedRDD[15] at coalesce at &lt;console&gt;:50 []\n |  MapPartitionsRDD[10] at mapValues at &lt;console&gt;:49 []\n |  ShuffledRDD[7] at partitionBy at &lt;console&gt;:48 []\n +-(8) MapPartitionsRDD[1] at map at &lt;console&gt;:47 []\n    |  ParallelCollectionRDD[0] at parallelize at &lt;console&gt;:46 []"},"output_type":"execute_result","execution_count":37}]},{"metadata":{},"cell_type":"markdown","source":"Compare the two query plans for `rddC` and `rddD`. Can you explain why the second query plan has on less shuffle phase?"},{"metadata":{},"cell_type":"markdown","source":"**See also**\n\n* http://spark.apache.org/examples.html\n* http://spark.apache.org/docs/latest/programming-guide.html\n\nAdditional info on Scala (just in case, some background may be useful to get things done, but do not get carried away - the course is about big data processing, not functional programming!)\n* Main [Scala site](http://scala-lang.org/), [tutorial](http://docs.scala-lang.org/tutorials/scala-for-java-programmers.html) and [API documentation](http://www.scala-lang.org/api/current/index.html)"}],"nbformat":4}