{"metadata":{"name":"Data Frame API Test","user_save_timestamp":"1970-01-01T00:00:00.000Z","auto_save_timestamp":"1970-01-01T00:00:00.000Z","language_info":{"name":"scala","file_extension":"scala","codemirror_mode":"text/x-scala"},"trusted":true,"customLocalRepo":null,"customRepos":null,"customDeps":null,"customImports":null,"customArgs":null,"customSparkConf":null},"cells":[{"metadata":{},"cell_type":"markdown","source":"# Using Data Frame API\n\nSpark Notebook to get started on using the Data Frame API"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val sqlContext = new org.apache.spark.sql.SQLContext(sc)\n\n// this is used to implicitly convert an RDD to a DataFrame.\nimport sqlContext.implicits._","outputs":[{"name":"stdout","output_type":"stream","text":"sqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@62b948af\nimport sqlContext.implicits._\n"},{"metadata":{},"data":{"text/html":"org.apache.spark.sql.SQLContext$implicits$@46db2f36"},"output_type":"execute_result","execution_count":1}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val df = sqlContext.read.json(\"/data/people.json\")","outputs":[{"name":"stdout","output_type":"stream","text":"df: org.apache.spark.sql.DataFrame = [age: bigint, name: string]\n"},{"metadata":{},"data":{"text/html":"<span style=\"color:red;\">Ooops, exception in the cell: </span>"},"output_type":"execute_result","execution_count":2}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"df.show()","outputs":[{"name":"stdout","output_type":"stream","text":"+----+-------+\n| age|   name|\n+----+-------+\n|null|Michael|\n|  30|   Andy|\n|  19| Justin|\n+----+-------+\n\n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":3}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"df.printSchema()","outputs":[{"name":"stdout","output_type":"stream","text":"root\n |-- age: long (nullable = true)\n |-- name: string (nullable = true)\n\n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":4}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"df.filter(df(\"age\") > 21).show()","outputs":[{"name":"stdout","output_type":"stream","text":"+---+----+\n|age|name|\n+---+----+\n| 30|Andy|\n+---+----+\n\n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":5}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"df.groupBy(\"age\").count().show()","outputs":[{"name":"stdout","output_type":"stream","text":"+----+-----+\n| age|count|\n+----+-----+\n|null|    1|\n|  19|    1|\n|  30|    1|\n+----+-----+\n\n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":6}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val ds = Seq(1, 2, 3).toDS()\nds.map(_ + 1).collect()","outputs":[{"name":"stdout","output_type":"stream","text":"ds: org.apache.spark.sql.Dataset[Int] = [value: int]\nres5: Array[Int] = Array(2, 3, 4)\n"},{"metadata":{},"data":{"text/html":"<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon410d18540863bdfdccddedc72154fd88&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:2},{&quot;_1&quot;:1,&quot;_2&quot;:3},{&quot;_1&quot;:2,&quot;_2&quot;:4}],&quot;genId&quot;:&quot;1017110457&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon17474b3b8fecbc1d6701c2d661e76af9\">\n      Max Points (controlling all tabs)\n    </label><input id=\"input-anon17474b3b8fecbc1d6701c2d661e76af9\" type=\"number\" name=\"input-anon17474b3b8fecbc1d6701c2d661e76af9\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon17474b3b8fecbc1d6701c2d661e76af9\" data-this=\"{&quot;valueId&quot;:&quot;anon17474b3b8fecbc1d6701c2d661e76af9&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <div>\n          <ul class=\"nav nav-tabs\" id=\"ul1017110457\"><li>\n                <a href=\"#tab1017110457-0\"><i class=\"fa fa-table\"/></a>\n              </li><li>\n                <a href=\"#tab1017110457-1\"><i class=\"fa fa-dot-circle-o\"/></a>\n              </li><li>\n                <a href=\"#tab1017110457-2\"><i class=\"fa fa-line-chart\"/></a>\n              </li><li>\n                <a href=\"#tab1017110457-3\"><i class=\"fa fa-bar-chart\"/></a>\n              </li></ul>\n\n          <div class=\"tab-content\" id=\"tab1017110457\"><div class=\"tab-pane\" id=\"tab1017110457-0\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon7bb4613b03993fc5fadd896c3d82331d&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:2},{&quot;_1&quot;:1,&quot;_2&quot;:3},{&quot;_1&quot;:2,&quot;_2&quot;:4}],&quot;genId&quot;:&quot;1448088934&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anondfbecd5869a03ae0c71063432b67249f\">\n      Max Points\n    </label><input id=\"input-anondfbecd5869a03ae0c71063432b67249f\" type=\"number\" name=\"input-anondfbecd5869a03ae0c71063432b67249f\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anondfbecd5869a03ae0c71063432b67249f\" data-this=\"{&quot;valueId&quot;:&quot;anondfbecd5869a03ae0c71063432b67249f&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon15e6b2e5081231eea22ae5c30f89d22c&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonb2dd477666b2bdd3f63cf14b39c2529e&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab1017110457-1\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon29ce643cb529125bbe4cbd2099fc0e65&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:2},{&quot;_1&quot;:1,&quot;_2&quot;:3},{&quot;_1&quot;:2,&quot;_2&quot;:4}],&quot;genId&quot;:&quot;722406122&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/scatterChart'], \n      function(playground, _magicscatterChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicscatterChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon34e94f8f73f6323d24c6471ca4c97233\">\n      Max Points\n    </label><input id=\"input-anon34e94f8f73f6323d24c6471ca4c97233\" type=\"number\" name=\"input-anon34e94f8f73f6323d24c6471ca4c97233\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon34e94f8f73f6323d24c6471ca4c97233\" data-this=\"{&quot;valueId&quot;:&quot;anon34e94f8f73f6323d24c6471ca4c97233&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon47aedfc06b9590549d70880e01704f17&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon3e39fc0d807af75f98b30566634e2c7f&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab1017110457-2\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon7a8db28be0a52009766c21e8fd9299d9&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:2},{&quot;_1&quot;:1,&quot;_2&quot;:3},{&quot;_1&quot;:2,&quot;_2&quot;:4}],&quot;genId&quot;:&quot;821728402&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/lineChart'], \n      function(playground, _magiclineChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magiclineChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anon16dd47f24888fdb44f70d6db0cf87c09\">\n      Max Points\n    </label><input id=\"input-anon16dd47f24888fdb44f70d6db0cf87c09\" type=\"number\" name=\"input-anon16dd47f24888fdb44f70d6db0cf87c09\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anon16dd47f24888fdb44f70d6db0cf87c09\" data-this=\"{&quot;valueId&quot;:&quot;anon16dd47f24888fdb44f70d6db0cf87c09&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anond8e7f9306a786188add29d1b2a7b3d07&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon57ca5f165d74d37b8bfdcd44b7b0b18d&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div><div class=\"tab-pane\" id=\"tab1017110457-3\">\n              <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anona65d4476dea427d5ad1b484b6cd781df&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:0,&quot;_2&quot;:2},{&quot;_1&quot;:1,&quot;_2&quot;:3},{&quot;_1&quot;:2,&quot;_2&quot;:4}],&quot;genId&quot;:&quot;1538356156&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/barChart'], \n      function(playground, _magicbarChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicbarChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <label for=\"input-anone30e4b34e6f4bd0880b49ab47662e48a\">\n      Max Points\n    </label><input id=\"input-anone30e4b34e6f4bd0880b49ab47662e48a\" type=\"number\" name=\"input-anone30e4b34e6f4bd0880b49ab47662e48a\" data-bind=\"textInput: value, fireChange: true, valueUpdate: 'input'\">\n      <script data-selector=\"#input-anone30e4b34e6f4bd0880b49ab47662e48a\" data-this=\"{&quot;valueId&quot;:&quot;anone30e4b34e6f4bd0880b49ab47662e48a&quot;,&quot;valueInit&quot;:25}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(\n ['observable', 'knockout'],\n function (Observable, ko) {\n   //console.log(\"-----------\")\n   //console.dir(this);\n   //console.dir(valueId);\n   var obs = Observable.makeObservable(valueId)\n                       .extend({ rateLimit: { //throttle\n                                   timeout: 500,\n                                   method: \"notifyWhenChangesStop\"\n                                 }\n                               }\n                       );\n   ko.applyBindings({\n     value: obs\n   }, this);\n   obs(valueInit);\n }\n)/*]]>*/</script>\n    </input>\n        <p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anoncebe223b1b4bb8518174407778158684&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> <span style=\"color:red\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon87945628b94794d37f8f68025f24c1e4&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n        <div>\n        </div>\n      </div></div>\n              </div></div>\n        </div>\n      </div></div>"},"output_type":"execute_result","execution_count":7}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val h = df.groupBy(\"age\").count()","outputs":[{"name":"stdout","output_type":"stream","text":"h: org.apache.spark.sql.DataFrame = [age: bigint, count: bigint]\n"},{"metadata":{},"data":{"text/html":"<span style=\"color:red;\">Ooops, exception in the cell: </span>"},"output_type":"execute_result","execution_count":8}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"h.explain","outputs":[{"name":"stdout","output_type":"stream","text":"== Physical Plan ==\nTungstenAggregate(key=[age#0L], functions=[(count(1),mode=Final,isDistinct=false)], output=[age#0L,count#12L])\n+- TungstenExchange hashpartitioning(age#0L,200), None\n   +- TungstenAggregate(key=[age#0L], functions=[(count(1),mode=Partial,isDistinct=false)], output=[age#0L,count#17L])\n      +- Scan JSONRelation[age#0L] InputPaths: file:/data/people.json\n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":9}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"import sqlContext.implicits._\ncase class T(a: Int, b: Double)\nval ds = Seq(1 -> T(1, 1D), 2 -> T(2, 2D)).toDS()","outputs":[{"name":"stdout","output_type":"stream","text":"org.apache.spark.sql.AnalysisException: Unable to generate an encoder for inner class `T` without access to the scope that this class was defined in. Try moving this class out of its parent class.;\n  at org.apache.spark.sql.catalyst.encoders.ExpressionEncoder$$anonfun$2.applyOrElse(ExpressionEncoder.scala:264)\n  at org.apache.spark.sql.catalyst.encoders.ExpressionEncoder$$anonfun$2.applyOrElse(ExpressionEncoder.scala:260)\n  at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$3.apply(TreeNode.scala:243)\n  at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$3.apply(TreeNode.scala:243)\n  at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:53)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:242)\n  at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformDown$1.apply(TreeNode.scala:248)\n  at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformDown$1.apply(TreeNode.scala:248)\n  at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:265)\n  at scala.collection.Iterator$$anon$11.next(Iterator.scala:370)\n  at scala.collection.Iterator$class.foreach(Iterator.scala:742)\n  at scala.collection.AbstractIterator.foreach(Iterator.scala:1194)\n  at scala.collection.generic.Growable$class.$plus$plus$eq(Growable.scala:59)\n  at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:104)\n  at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:48)\n  at scala.collection.TraversableOnce$class.to(TraversableOnce.scala:308)\n  at scala.collection.AbstractIterator.to(Iterator.scala:1194)\n  at scala.collection.TraversableOnce$class.toBuffer(TraversableOnce.scala:300)\n  at scala.collection.AbstractIterator.toBuffer(Iterator.scala:1194)\n  at scala.collection.TraversableOnce$class.toArray(TraversableOnce.scala:287)\n  at scala.collection.AbstractIterator.toArray(Iterator.scala:1194)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.transformChildren(TreeNode.scala:305)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:248)\n  at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformDown$1.apply(TreeNode.scala:248)\n  at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformDown$1.apply(TreeNode.scala:248)\n  at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4$$anonfun$apply$9.apply(TreeNode.scala:294)\n  at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:245)\n  at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:245)\n  at scala.collection.immutable.List.foreach(List.scala:381)\n  at scala.collection.TraversableLike$class.map(TraversableLike.scala:245)\n  at scala.collection.immutable.List.map(List.scala:285)\n  at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:292)\n  at scala.collection.Iterator$$anon$11.next(Iterator.scala:370)\n  at scala.collection.Iterator$class.foreach(Iterator.scala:742)\n  at scala.collection.AbstractIterator.foreach(Iterator.scala:1194)\n  at scala.collection.generic.Growable$class.$plus$plus$eq(Growable.scala:59)\n  at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:104)\n  at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:48)\n  at scala.collection.TraversableOnce$class.to(TraversableOnce.scala:308)\n  at scala.collection.AbstractIterator.to(Iterator.scala:1194)\n  at scala.collection.TraversableOnce$class.toBuffer(TraversableOnce.scala:300)\n  at scala.collection.AbstractIterator.toBuffer(Iterator.scala:1194)\n  at scala.collection.TraversableOnce$class.toArray(TraversableOnce.scala:287)\n  at scala.collection.AbstractIterator.toArray(Iterator.scala:1194)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.transformChildren(TreeNode.scala:305)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:248)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.transform(TreeNode.scala:233)\n  at org.apache.spark.sql.catalyst.encoders.ExpressionEncoder.resolve(ExpressionEncoder.scala:260)\n  at org.apache.spark.sql.Dataset.<init>(Dataset.scala:78)\n  at org.apache.spark.sql.Dataset.<init>(Dataset.scala:89)\n  at org.apache.spark.sql.SQLContext.createDataset(SQLContext.scala:507)\n  at org.apache.spark.sql.SQLImplicits.localSeqToDatasetHolder(SQLImplicits.scala:80)\n  ... 33 elided\n"}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"import sqlContext.implicits._\ncase class T(a: Int, b: Double)\norg.apache.spark.sql.catalyst.encoders.OuterScopes.addOuterScope(this)","outputs":[{"name":"stdout","output_type":"stream","text":"import sqlContext.implicits._\ndefined class T\n"},{"metadata":{},"data":{"text/html":"org.apache.spark.sql.SQLContext$implicits$@46db2f36"},"output_type":"execute_result","execution_count":17}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val data = Seq(1 -> T(1, 1D), 2 -> T(2, 2D))\nval ds = data.toDS()","outputs":[{"name":"stdout","output_type":"stream","text":"data: Seq[(Int, T)] = List((1,T(1,1.0)), (2,T(2,2.0)))\nds: org.apache.spark.sql.Dataset[(Int, T)] = [_1: int, _2: struct<a:int,b:double>]\n"},{"metadata":{},"data":{"text/html":"[_1: int, _2: struct&lt;a:int,b:double&gt;]"},"output_type":"execute_result","execution_count":23}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"import sqlContext.implicits._\ncase class T(a: Int, b: Double)\norg.apache.spark.sql.catalyst.encoders.OuterScopes.addOuterScope(this)\nval ds = Seq(1 -> T(1, 1D), 2 -> T(2, 2D)).toDS()","outputs":[{"name":"stdout","output_type":"stream","text":"import sqlContext.implicits._\ndefined class T\nds: org.apache.spark.sql.Dataset[(Int, T)] = [_1: int, _2: struct<a:int,b:double>]\n"},{"metadata":{},"data":{"text/html":"org.apache.spark.sql.SQLContext$implicits$@46db2f36"},"output_type":"execute_result","execution_count":25}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"ds.show()","outputs":[{"name":"stdout","output_type":"stream","text":"+---+-------+\n| _1|     _2|\n+---+-------+\n|  1|[1,1.0]|\n|  2|[2,2.0]|\n+---+-------+\n\n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":1}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"case class Person(name: String, age: Long)\norg.apache.spark.sql.catalyst.encoders.OuterScopes.addOuterScope(this)\n\nval ds = Seq(Person(\"Andy\", 32)).toDS()","outputs":[{"name":"stdout","output_type":"stream","text":"defined class Person\nds: org.apache.spark.sql.Dataset[Person] = [name: string, age: bigint]\n"},{"metadata":{},"data":{"text/html":"[name: string, age: bigint]"},"output_type":"execute_result","execution_count":2}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"ds.show()","outputs":[{"name":"stdout","output_type":"stream","text":"+----+---+\n|name|age|\n+----+---+\n|Andy| 32|\n+----+---+\n\n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":3}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val df = sqlContext.sql(\"SELECT * FROM table\")","outputs":[{"name":"stdout","output_type":"stream","text":"java.lang.RuntimeException: [1.15] failure: ``('' expected but `table' found\n\nSELECT * FROM table\n              ^\n  at scala.sys.package$.error(package.scala:27)\n  at org.apache.spark.sql.catalyst.AbstractSparkSQLParser.parse(AbstractSparkSQLParser.scala:36)\n  at org.apache.spark.sql.catalyst.DefaultParserDialect.parse(ParserDialect.scala:67)\n  at org.apache.spark.sql.SQLContext$$anonfun$2.apply(SQLContext.scala:211)\n  at org.apache.spark.sql.SQLContext$$anonfun$2.apply(SQLContext.scala:211)\n  at org.apache.spark.sql.execution.SparkSQLParser$$anonfun$org$apache$spark$sql$execution$SparkSQLParser$$others$1.apply(SparkSQLParser.scala:114)\n  at org.apache.spark.sql.execution.SparkSQLParser$$anonfun$org$apache$spark$sql$execution$SparkSQLParser$$others$1.apply(SparkSQLParser.scala:113)\n  at scala.util.parsing.combinator.Parsers$Success.map(Parsers.scala:137)\n  at scala.util.parsing.combinator.Parsers$Success.map(Parsers.scala:136)\n  at scala.util.parsing.combinator.Parsers$Parser$$anonfun$map$1.apply(Parsers.scala:237)\n  at scala.util.parsing.combinator.Parsers$Parser$$anonfun$map$1.apply(Parsers.scala:237)\n  at scala.util.parsing.combinator.Parsers$$anon$3.apply(Parsers.scala:217)\n  at scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1$$anonfun$apply$2.apply(Parsers.scala:249)\n  at scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1$$anonfun$apply$2.apply(Parsers.scala:249)\n  at scala.util.parsing.combinator.Parsers$Failure.append(Parsers.scala:197)\n  at scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1.apply(Parsers.scala:249)\n  at scala.util.parsing.combinator.Parsers$Parser$$anonfun$append$1.apply(Parsers.scala:249)\n  at scala.util.parsing.combinator.Parsers$$anon$3.apply(Parsers.scala:217)\n  at scala.util.parsing.combinator.Parsers$$anon$2$$anonfun$apply$14.apply(Parsers.scala:882)\n  at scala.util.parsing.combinator.Parsers$$anon$2$$anonfun$apply$14.apply(Parsers.scala:882)\n  at scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n  at scala.util.parsing.combinator.Parsers$$anon$2.apply(Parsers.scala:881)\n  at scala.util.parsing.combinator.PackratParsers$$anon$1.apply(PackratParsers.scala:110)\n  at org.apache.spark.sql.catalyst.AbstractSparkSQLParser.parse(AbstractSparkSQLParser.scala:34)\n  at org.apache.spark.sql.SQLContext$$anonfun$1.apply(SQLContext.scala:208)\n  at org.apache.spark.sql.SQLContext$$anonfun$1.apply(SQLContext.scala:208)\n  at org.apache.spark.sql.execution.datasources.DDLParser.parse(DDLParser.scala:43)\n  at org.apache.spark.sql.SQLContext.parseSql(SQLContext.scala:231)\n  at org.apache.spark.sql.SQLContext.sql(SQLContext.scala:817)\n  ... 33 elided\n"}]}],"nbformat":4}